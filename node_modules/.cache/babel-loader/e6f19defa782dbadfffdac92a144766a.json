{"remainingRequest":"C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\node_modules\\dxf-viewer\\src\\DxfViewer.js","dependencies":[{"path":"C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\node_modules\\dxf-viewer\\src\\DxfViewer.js","mtime":1704432456000},{"path":"C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\babel.config.js","mtime":1694764762000},{"path":"C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1704432454000},{"path":"C:\\Users\\SDC-8\\Desktop\\Sowndarya\\CMTI ALL PROJECTS\\GERB-INDIA(CLIENT)\\GerbIndiaDashboard-CMTI-Full\\SmartMetrology\\smart-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1704432454000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgdGhyZWUgZnJvbSAidGhyZWUiOwppbXBvcnQgeyBCYXRjaGluZ0tleSB9IGZyb20gIi4vQmF0Y2hpbmdLZXkiOwppbXBvcnQgeyBEeGZXb3JrZXIgfSBmcm9tICIuL0R4ZldvcmtlciI7CmltcG9ydCB7IE1hdGVyaWFsS2V5IH0gZnJvbSAiLi9NYXRlcmlhbEtleSI7CmltcG9ydCB7IENvbG9yQ29kZSwgRHhmU2NlbmUgfSBmcm9tICIuL0R4ZlNjZW5lIjsKaW1wb3J0IHsgT3JiaXRDb250cm9scyB9IGZyb20gIi4vT3JiaXRDb250cm9scyI7CmltcG9ydCB7IFJCVHJlZSB9IGZyb20gIi4vUkJUcmVlIjsKCi8qKiBMZXZlbCBpbiAibWVzc2FnZSIgZXZlbnRzLiAqLwpjb25zdCBNZXNzYWdlTGV2ZWwgPSBPYmplY3QuZnJlZXplKHsKICBJTkZPOiAiaW5mbyIsCiAgV0FSTjogIndhcm4iLAogIEVSUk9SOiAiZXJyb3IiCn0pOwoKLyoqIFRoZSByZXByZXNlbnRhdGlvbiBjbGFzcyBmb3IgdGhlIHZpZXdlciwgYmFzZWQgb24gVGhyZWUuanMgV2ViR0wgcmVuZGVyZXIuICovCmV4cG9ydCBjbGFzcyBEeGZWaWV3ZXIgewogIC8qKiBAcGFyYW0gZG9tQ29udGFpbmVyIENvbnRhaW5lciBlbGVtZW50IHRvIGNyZWF0ZSB0aGUgY2FudmFzIGluLiBVc3VhbGx5IGVtcHR5IGRpdi4gU2hvdWxkIG5vdAogICAqICBoYXZlIHBhZGRpbmcgaWYgYXV0by1yZXNpemUgZmVhdHVyZSBpcyB1c2VkLgogICAqIEBwYXJhbSBvcHRpb25zIFNvbWUgb3B0aW9ucyBjYW4gYmUgb3ZlcnJpZGRlbiBpZiBzcGVjaWZpZWQuIFNlZSBEeGZWaWV3ZXIuRGVmYXVsdE9wdGlvbnMuCiAgICovCiAgY29uc3RydWN0b3IoZG9tQ29udGFpbmVyLCBvcHRpb25zID0gbnVsbCkgewogICAgdGhpcy5kb21Db250YWluZXIgPSBkb21Db250YWluZXI7CiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKER4ZlZpZXdlci5EZWZhdWx0T3B0aW9ucyk7CiAgICBpZiAob3B0aW9ucykgewogICAgICBPYmplY3QuYXNzaWduKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB9CiAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zOwogICAgdGhpcy5jbGVhckNvbG9yID0gdGhpcy5vcHRpb25zLmNsZWFyQ29sb3IuZ2V0SGV4KCk7CiAgICB0aGlzLnNjZW5lID0gbmV3IHRocmVlLlNjZW5lKCk7CiAgICB0cnkgewogICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IHRocmVlLldlYkdMUmVuZGVyZXIoewogICAgICAgIGFscGhhOiBvcHRpb25zLmNhbnZhc0FscGhhLAogICAgICAgIHByZW11bHRpcGxpZWRBbHBoYTogb3B0aW9ucy5jYW52YXNQcmVtdWx0aXBsaWVkQWxwaGEsCiAgICAgICAgYW50aWFsaWFzOiBvcHRpb25zLmFudGlhbGlhcywKICAgICAgICBkZXB0aDogZmFsc2UsCiAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBvcHRpb25zLnByZXNlcnZlRHJhd2luZ0J1ZmZlcgogICAgICB9KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBjcmVhdGUgcmVuZGVyZXI6ICIgKyBlKTsKICAgICAgdGhpcy5yZW5kZXJlciA9IG51bGw7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlcjsKICAgIHJlbmRlcmVyLnNldFBpeGVsUmF0aW8od2luZG93LmRldmljZVBpeGVsUmF0aW8pOwogICAgY29uc3QgY2FtZXJhID0gdGhpcy5jYW1lcmEgPSBuZXcgdGhyZWUuT3J0aG9ncmFwaGljQ2FtZXJhKC0xLCAxLCAxLCAtMSwgMC4xLCAyKTsKICAgIGNhbWVyYS5wb3NpdGlvbi56ID0gMTsKICAgIGNhbWVyYS5wb3NpdGlvbi54ID0gMDsKICAgIGNhbWVyYS5wb3NpdGlvbi55ID0gMDsKICAgIHRoaXMuc2ltcGxlQ29sb3JNYXRlcmlhbCA9IFtdOwogICAgdGhpcy5zaW1wbGVQb2ludE1hdGVyaWFsID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IEluc3RhbmNlVHlwZS5NQVg7IGkrKykgewogICAgICB0aGlzLnNpbXBsZUNvbG9yTWF0ZXJpYWxbaV0gPSB0aGlzLl9DcmVhdGVTaW1wbGVDb2xvck1hdGVyaWFsKGkpOwogICAgICB0aGlzLnNpbXBsZVBvaW50TWF0ZXJpYWxbaV0gPSB0aGlzLl9DcmVhdGVTaW1wbGVQb2ludE1hdGVyaWFsKGkpOwogICAgfQogICAgcmVuZGVyZXIuc2V0Q2xlYXJDb2xvcihvcHRpb25zLmNsZWFyQ29sb3IsIG9wdGlvbnMuY2xlYXJBbHBoYSk7CiAgICBpZiAob3B0aW9ucy5hdXRvUmVzaXplKSB7CiAgICAgIHRoaXMuY2FudmFzV2lkdGggPSBkb21Db250YWluZXIuY2xpZW50V2lkdGg7CiAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gZG9tQ29udGFpbmVyLmNsaWVudEhlaWdodDsKICAgICAgZG9tQ29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY2FudmFzV2lkdGggPSBvcHRpb25zLmNhbnZhc1dpZHRoOwogICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IG9wdGlvbnMuY2FudmFzSGVpZ2h0OwogICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbnVsbDsKICAgIH0KICAgIHJlbmRlcmVyLnNldFNpemUodGhpcy5jYW52YXNXaWR0aCwgdGhpcy5jYW52YXNIZWlnaHQpOwogICAgdGhpcy5jYW52YXMgPSByZW5kZXJlci5kb21FbGVtZW50OwogICAgZG9tQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgaWYgKG9wdGlvbnMuYXV0b1Jlc2l6ZSkgewogICAgICB0aGlzLmNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZW50cmllcyA9PiB0aGlzLl9PblJlc2l6ZShlbnRyaWVzWzBdKSk7CiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShkb21Db250YWluZXIpOwogICAgfQogICAgZG9tQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTsKICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgdGhpcy5fT25Qb2ludGVyRXZlbnQuYmluZCh0aGlzKSk7CiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCB0aGlzLl9PblBvaW50ZXJFdmVudC5iaW5kKHRoaXMpKTsKICAgIHRoaXMuUmVuZGVyKCk7CgogICAgLyogSW5kZXhlZCBieSBNYXRlcmlhbEtleSwgdmFsdWUgaXMge2tleSwgbWF0ZXJpYWx9LiAqLwogICAgdGhpcy5tYXRlcmlhbHMgPSBuZXcgUkJUcmVlKChtMSwgbTIpID0+IG0xLmtleS5Db21wYXJlKG0yLmtleSkpOwogICAgLyogSW5kZXhlZCBieSBsYXllciBuYW1lLCB2YWx1ZSBpcyBMYXllciBpbnN0YW5jZS4gKi8KICAgIHRoaXMubGF5ZXJzID0gbmV3IE1hcCgpOwogICAgLyogSW5kZXhlZCBieSBibG9jayBuYW1lLCB2YWx1ZSBpcyBCbG9jayBpbnN0YW5jZS4gKi8KICAgIHRoaXMuYmxvY2tzID0gbmV3IE1hcCgpOwoKICAgIC8qKiBTZXQgZHVyaW5nIGRhdGEgbG9hZGluZy4gKi8KICAgIHRoaXMud29ya2VyID0gbnVsbDsKICB9CgogIC8qKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHJlbmRlcmVyIGV4aXN0cy4gTWF5IGJlIGZhbHNlIGluIGNhc2Ugd2hlbiBXZWJHTCBjb250ZXh0IGlzIGxvc3QKICAgKiAoZS5nLiBhZnRlciB3YWtlIHVwIGZyb20gc2xlZXApLiBJbiBzdWNoIGNhc2UgcGFnZSBzaG91bGQgYmUgcmVsb2FkZWQuCiAgICovCiAgSGFzUmVuZGVyZXIoKSB7CiAgICByZXR1cm4gQm9vbGVhbih0aGlzLnJlbmRlcmVyKTsKICB9CgogIC8qKgogICAqIEByZXR1cm5zIHt0aHJlZS5XZWJHTFJlbmRlcmVyIHwgbnVsbH0gUmV0dXJucyB0aGUgY3JlYXRlZCBUaHJlZS5qcyByZW5kZXJlci4KICAgKi8KICBHZXRSZW5kZXJlcigpIHsKICAgIHJldHVybiB0aGlzLnJlbmRlcmVyOwogIH0KICBHZXRDYW52YXMoKSB7CiAgICByZXR1cm4gdGhpcy5jYW52YXM7CiAgfQogIEdldER4ZigpIHsKICAgIHJldHVybiB0aGlzLnBhcnNlZER4ZjsKICB9CiAgU2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KSB7CiAgICB0aGlzLl9FbnN1cmVSZW5kZXJlcigpOwogICAgY29uc3QgaFNjYWxlID0gd2lkdGggLyB0aGlzLmNhbnZhc1dpZHRoOwogICAgY29uc3QgdlNjYWxlID0gaGVpZ2h0IC8gdGhpcy5jYW52YXNIZWlnaHQ7CiAgICBjb25zdCBjYW0gPSB0aGlzLmNhbWVyYTsKICAgIGNvbnN0IGNlbnRlclggPSAoY2FtLmxlZnQgKyBjYW0ucmlnaHQpIC8gMjsKICAgIGNvbnN0IGNlbnRlclkgPSAoY2FtLmJvdHRvbSArIGNhbS50b3ApIC8gMjsKICAgIGNvbnN0IGNhbVdpZHRoID0gY2FtLnJpZ2h0IC0gY2FtLmxlZnQ7CiAgICBjb25zdCBjYW1IZWlnaHQgPSBjYW0udG9wIC0gY2FtLmJvdHRvbTsKICAgIGNhbS5sZWZ0ID0gY2VudGVyWCAtIGhTY2FsZSAqIGNhbVdpZHRoIC8gMjsKICAgIGNhbS5yaWdodCA9IGNlbnRlclggKyBoU2NhbGUgKiBjYW1XaWR0aCAvIDI7CiAgICBjYW0uYm90dG9tID0gY2VudGVyWSAtIHZTY2FsZSAqIGNhbUhlaWdodCAvIDI7CiAgICBjYW0udG9wID0gY2VudGVyWSArIHZTY2FsZSAqIGNhbUhlaWdodCAvIDI7CiAgICBjYW0udXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwogICAgdGhpcy5jYW52YXNXaWR0aCA9IHdpZHRoOwogICAgdGhpcy5jYW52YXNIZWlnaHQgPSBoZWlnaHQ7CiAgICB0aGlzLnJlbmRlcmVyLnNldFNpemUod2lkdGgsIGhlaWdodCk7CiAgICBpZiAodGhpcy5jb250cm9scykgewogICAgICB0aGlzLmNvbnRyb2xzLnVwZGF0ZSgpOwogICAgfQogICAgdGhpcy5fRW1pdCgicmVzaXplZCIsIHsKICAgICAgd2lkdGgsCiAgICAgIGhlaWdodAogICAgfSk7CiAgICB0aGlzLl9FbWl0KCJ2aWV3Q2hhbmdlZCIpOwogICAgdGhpcy5SZW5kZXIoKTsKICB9CgogIC8qKiBMb2FkIERYRiBpbnRvIHRoZSB2aWV3ZXIuIE9sZCBjb250ZW50IGlzIGRpc2NhcmRlZCwgc3RhdGUgaXMgcmVzZXQuCiAgICogQHBhcmFtIHVybCB7c3RyaW5nfSBEWEYgZmlsZSBVUkwuCiAgICogQHBhcmFtIGZvbnRzIHs/c3RyaW5nW119IExpc3Qgb2YgZm9udCBVUkxzLiBGaWxlcyBzaG91bGQgaGF2ZSB0eXBlZmFjZS5qcyBmb3JtYXQuIEZvbnRzIGFyZQogICAqICB1c2VkIGluIHRoZSBzcGVjaWZpZWQgb3JkZXIsIGVhY2ggb25lIGlzIGNoZWNrZWQgdW50aWwgbmVjZXNzYXJ5IGdseXBoIGlzIGZvdW5kLiBUZXh0IGlzIG5vdAogICAqICByZW5kZXJlZCBpZiBmb250cyBhcmUgbm90IHNwZWNpZmllZC4KICAgKiBAcGFyYW0gcHJvZ3Jlc3NDYmsgez9GdW5jdGlvbn0gKHBoYXNlLCBwcm9jZXNzZWRTaXplLCB0b3RhbFNpemUpCiAgICogIFBvc3NpYmxlIHBoYXNlIHZhbHVlczoKICAgKiAgKiAiZm9udCIKICAgKiAgKiAiZmV0Y2giCiAgICogICogInBhcnNlIgogICAqICAqICJwcmVwYXJlIgogICAqIEBwYXJhbSB3b3JrZXJGYWN0b3J5IHs/RnVuY3Rpb259IEZhY3RvcnkgZm9yIHdvcmtlciBjcmVhdGlvbi4gVGhlIHdvcmtlciBzY3JpcHQgc2hvdWxkCiAgICogIGludm9rZSBEeGZWaWV3ZXIuU2V0dXBXb3JrZXIoKSBmdW5jdGlvbi4KICAgKi8KICBhc3luYyBMb2FkKHsKICAgIHVybCwKICAgIGZvbnRzID0gbnVsbCwKICAgIHByb2dyZXNzQ2JrID0gbnVsbCwKICAgIHdvcmtlckZhY3RvcnkgPSBudWxsCiAgfSkgewogICAgaWYgKHVybCA9PT0gbnVsbCB8fCB1cmwgPT09IHVuZGVmaW5lZCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoImB1cmxgIHBhcmFtZXRlciBpcyBub3Qgc3BlY2lmaWVkIik7CiAgICB9CiAgICB0aGlzLl9FbnN1cmVSZW5kZXJlcigpOwogICAgdGhpcy5DbGVhcigpOwogICAgdGhpcy53b3JrZXIgPSBuZXcgRHhmV29ya2VyKHdvcmtlckZhY3RvcnkgPyB3b3JrZXJGYWN0b3J5KCkgOiBudWxsKTsKICAgIGNvbnN0IHsKICAgICAgc2NlbmUsCiAgICAgIGR4ZgogICAgfSA9IGF3YWl0IHRoaXMud29ya2VyLkxvYWQodXJsLCBmb250cywgdGhpcy5vcHRpb25zLCBwcm9ncmVzc0Niayk7CiAgICBhd2FpdCB0aGlzLndvcmtlci5EZXN0cm95KCk7CiAgICB0aGlzLndvcmtlciA9IG51bGw7CiAgICB0aGlzLnBhcnNlZER4ZiA9IGR4ZjsKICAgIHRoaXMub3JpZ2luID0gc2NlbmUub3JpZ2luOwogICAgdGhpcy5ib3VuZHMgPSBzY2VuZS5ib3VuZHM7CiAgICB0aGlzLmhhc01pc3NpbmdDaGFycyA9IHNjZW5lLmhhc01pc3NpbmdDaGFyczsKICAgIGZvciAoY29uc3QgbGF5ZXIgb2Ygc2NlbmUubGF5ZXJzKSB7CiAgICAgIHRoaXMubGF5ZXJzLnNldChsYXllci5uYW1lLCBuZXcgTGF5ZXIobGF5ZXIubmFtZSwgbGF5ZXIuZGlzcGxheU5hbWUsIGxheWVyLmNvbG9yKSk7CiAgICB9CgogICAgLyogTG9hZCBhbGwgYmxvY2tzIG9uIHRoZSBmaXJzdCBwYXNzLiAqLwogICAgZm9yIChjb25zdCBiYXRjaCBvZiBzY2VuZS5iYXRjaGVzKSB7CiAgICAgIGlmIChiYXRjaC5rZXkuYmxvY2tOYW1lICE9PSBudWxsICYmIGJhdGNoLmtleS5nZW9tZXRyeVR5cGUgIT09IEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5CTE9DS19JTlNUQU5DRSAmJiBiYXRjaC5rZXkuZ2VvbWV0cnlUeXBlICE9PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRfSU5TVEFOQ0UpIHsKICAgICAgICBsZXQgYmxvY2sgPSB0aGlzLmJsb2Nrcy5nZXQoYmF0Y2gua2V5LmJsb2NrTmFtZSk7CiAgICAgICAgaWYgKCFibG9jaykgewogICAgICAgICAgYmxvY2sgPSBuZXcgQmxvY2soKTsKICAgICAgICAgIHRoaXMuYmxvY2tzLnNldChiYXRjaC5rZXkuYmxvY2tOYW1lLCBibG9jayk7CiAgICAgICAgfQogICAgICAgIGJsb2NrLlB1c2hCYXRjaChuZXcgQmF0Y2godGhpcywgc2NlbmUsIGJhdGNoKSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnNvbGUubG9nKGBEWEYgc2NlbmU6CiAgICAgICAgICAgICAgICAgICAgICR7c2NlbmUuYmF0Y2hlcy5sZW5ndGh9IGJhdGNoZXMsCiAgICAgICAgICAgICAgICAgICAgICR7dGhpcy5sYXllcnMuc2l6ZX0gbGF5ZXJzLAogICAgICAgICAgICAgICAgICAgICAke3RoaXMuYmxvY2tzLnNpemV9IGJsb2NrcywKICAgICAgICAgICAgICAgICAgICAgdmVydGljZXMgJHtzY2VuZS52ZXJ0aWNlcy5ieXRlTGVuZ3RofSBCLAogICAgICAgICAgICAgICAgICAgICBpbmRpY2VzICR7c2NlbmUuaW5kaWNlcy5ieXRlTGVuZ3RofSBCCiAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybXMgJHtzY2VuZS50cmFuc2Zvcm1zLmJ5dGVMZW5ndGh9IEJgKTsKCiAgICAvKiBJbnN0YW50aWF0ZSBhbGwgZW50aXRpZXMuICovCiAgICBmb3IgKGNvbnN0IGJhdGNoIG9mIHNjZW5lLmJhdGNoZXMpIHsKICAgICAgdGhpcy5fTG9hZEJhdGNoKHNjZW5lLCBiYXRjaCk7CiAgICB9CiAgICB0aGlzLl9FbWl0KCJsb2FkZWQiKTsKICAgIGlmIChzY2VuZS5ib3VuZHMpIHsKICAgICAgdGhpcy5GaXRWaWV3KHNjZW5lLmJvdW5kcy5taW5YIC0gc2NlbmUub3JpZ2luLngsIHNjZW5lLmJvdW5kcy5tYXhYIC0gc2NlbmUub3JpZ2luLngsIHNjZW5lLmJvdW5kcy5taW5ZIC0gc2NlbmUub3JpZ2luLnksIHNjZW5lLmJvdW5kcy5tYXhZIC0gc2NlbmUub3JpZ2luLnkpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5fTWVzc2FnZSgiRW1wdHkgZG9jdW1lbnQiLCBNZXNzYWdlTGV2ZWwuV0FSTik7CiAgICB9CiAgICBpZiAodGhpcy5oYXNNaXNzaW5nQ2hhcnMpIHsKICAgICAgdGhpcy5fTWVzc2FnZSgiU29tZSBjaGFyYWN0ZXJzIGNhbm5vdCBiZSBwcm9wZXJseSBkaXNwbGF5ZWQgZHVlIHRvIG1pc3NpbmcgZm9udHMiLCBNZXNzYWdlTGV2ZWwuV0FSTik7CiAgICB9CiAgICB0aGlzLl9DcmVhdGVDb250cm9scygpOwogICAgdGhpcy5SZW5kZXIoKTsKICB9CiAgUmVuZGVyKCkgewogICAgdGhpcy5fRW5zdXJlUmVuZGVyZXIoKTsKICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhKTsKICB9CgogIC8qKiBAcmV0dXJuIHtJdGVyYWJsZTx7bmFtZTpTdHJpbmcsIGNvbG9yOm51bWJlcn0+fSBMaXN0IG9mIGxheWVyIG5hbWVzLiAqLwogIEdldExheWVycygpIHsKICAgIGNvbnN0IHJlc3VsdCA9IFtdOwogICAgZm9yIChjb25zdCBseXIgb2YgdGhpcy5sYXllcnMudmFsdWVzKCkpIHsKICAgICAgcmVzdWx0LnB1c2goewogICAgICAgIG5hbWU6IGx5ci5uYW1lLAogICAgICAgIGRpc3BsYXlOYW1lOiBseXIuZGlzcGxheU5hbWUsCiAgICAgICAgY29sb3I6IHRoaXMuX1RyYW5zZm9ybUNvbG9yKGx5ci5jb2xvcikKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICBTaG93TGF5ZXIobmFtZSwgc2hvdykgewogICAgdGhpcy5fRW5zdXJlUmVuZGVyZXIoKTsKICAgIGNvbnN0IGxheWVyID0gdGhpcy5sYXllcnMuZ2V0KG5hbWUpOwogICAgaWYgKCFsYXllcikgewogICAgICByZXR1cm47CiAgICB9CiAgICBmb3IgKGNvbnN0IG9iaiBvZiBsYXllci5vYmplY3RzKSB7CiAgICAgIG9iai52aXNpYmxlID0gc2hvdzsKICAgIH0KICAgIHRoaXMuUmVuZGVyKCk7CiAgfQoKICAvKiogUmVzZXQgdGhlIHZpZXdlciBzdGF0ZS4gKi8KICBDbGVhcigpIHsKICAgIHRoaXMuX0Vuc3VyZVJlbmRlcmVyKCk7CiAgICBpZiAodGhpcy53b3JrZXIpIHsKICAgICAgdGhpcy53b3JrZXIuRGVzdHJveSh0cnVlKTsKICAgICAgdGhpcy53b3JrZXIgPSBudWxsOwogICAgfQogICAgaWYgKHRoaXMuY29udHJvbHMpIHsKICAgICAgdGhpcy5jb250cm9scy5kaXNwb3NlKCk7CiAgICAgIHRoaXMuY29udHJvbHMgPSBudWxsOwogICAgfQogICAgdGhpcy5zY2VuZS5jbGVhcigpOwogICAgZm9yIChjb25zdCBsYXllciBvZiB0aGlzLmxheWVycy52YWx1ZXMoKSkgewogICAgICBsYXllci5EaXNwb3NlKCk7CiAgICB9CiAgICB0aGlzLmxheWVycy5jbGVhcigpOwogICAgdGhpcy5ibG9ja3MuY2xlYXIoKTsKICAgIHRoaXMubWF0ZXJpYWxzLmVhY2goZSA9PiBlLm1hdGVyaWFsLmRpc3Bvc2UoKSk7CiAgICB0aGlzLm1hdGVyaWFscy5jbGVhcigpOwogICAgdGhpcy5TZXRWaWV3KHsKICAgICAgeDogMCwKICAgICAgeTogMAogICAgfSwgMik7CiAgICB0aGlzLl9FbWl0KCJjbGVhcmVkIik7CiAgICB0aGlzLlJlbmRlcigpOwogIH0KCiAgLyoqIEZyZWUgYWxsIHJlc291cmNlcy4gVGhlIHZpZXdlciBvYmplY3Qgc2hvdWxkIG5vdCBiZSB1c2VkIGFmdGVyIHRoaXMgbWV0aG9kIHdhcyBjYWxsZWQuICovCiAgRGVzdHJveSgpIHsKICAgIGlmICghdGhpcy5IYXNSZW5kZXJlcigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyKSB7CiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgfQogICAgdGhpcy5DbGVhcigpOwogICAgdGhpcy5fRW1pdCgiZGVzdHJveWVkIik7CiAgICBmb3IgKGNvbnN0IG0gb2YgdGhpcy5zaW1wbGVQb2ludE1hdGVyaWFsKSB7CiAgICAgIG0uZGlzcG9zZSgpOwogICAgfQogICAgZm9yIChjb25zdCBtIG9mIHRoaXMuc2ltcGxlQ29sb3JNYXRlcmlhbCkgewogICAgICBtLmRpc3Bvc2UoKTsKICAgIH0KICAgIHRoaXMuc2ltcGxlUG9pbnRNYXRlcmlhbCA9IG51bGw7CiAgICB0aGlzLnNpbXBsZUNvbG9yTWF0ZXJpYWwgPSBudWxsOwogICAgdGhpcy5yZW5kZXJlci5kaXNwb3NlKCk7CiAgICB0aGlzLnJlbmRlcmVyID0gbnVsbDsKICB9CiAgU2V0VmlldyhjZW50ZXIsIHdpZHRoKSB7CiAgICBjb25zdCBhc3BlY3QgPSB0aGlzLmNhbnZhc1dpZHRoIC8gdGhpcy5jYW52YXNIZWlnaHQ7CiAgICBjb25zdCBoZWlnaHQgPSB3aWR0aCAvIGFzcGVjdDsKICAgIGNvbnN0IGNhbSA9IHRoaXMuY2FtZXJhOwogICAgY2FtLmxlZnQgPSAtd2lkdGggLyAyOwogICAgY2FtLnJpZ2h0ID0gd2lkdGggLyAyOwogICAgY2FtLnRvcCA9IGhlaWdodCAvIDI7CiAgICBjYW0uYm90dG9tID0gLWhlaWdodCAvIDI7CiAgICBjYW0uem9vbSA9IDE7CiAgICBjYW0ucG9zaXRpb24uc2V0KGNlbnRlci54LCBjZW50ZXIueSwgMSk7CiAgICBjYW0ucm90YXRpb24uc2V0KDAsIDAsIDApOwogICAgY2FtLnVwZGF0ZU1hdHJpeCgpOwogICAgY2FtLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgIHRoaXMuX0VtaXQoInZpZXdDaGFuZ2VkIik7CiAgfQoKICAvKiogU2V0IHZpZXcgdG8gZml0IHRoZSBzcGVjaWZpZWQgYm91bmRzLiAqLwogIEZpdFZpZXcobWluWCwgbWF4WCwgbWluWSwgbWF4WSwgcGFkZGluZyA9IDAuMSkgewogICAgY29uc3QgYXNwZWN0ID0gdGhpcy5jYW52YXNXaWR0aCAvIHRoaXMuY2FudmFzSGVpZ2h0OwogICAgbGV0IHdpZHRoID0gbWF4WCAtIG1pblg7CiAgICBjb25zdCBoZWlnaHQgPSBtYXhZIC0gbWluWTsKICAgIGNvbnN0IGNlbnRlciA9IHsKICAgICAgeDogbWluWCArIHdpZHRoIC8gMiwKICAgICAgeTogbWluWSArIGhlaWdodCAvIDIKICAgIH07CiAgICBpZiAoaGVpZ2h0ICogYXNwZWN0ID4gd2lkdGgpIHsKICAgICAgd2lkdGggPSBoZWlnaHQgKiBhc3BlY3Q7CiAgICB9CiAgICBpZiAod2lkdGggPD0gTnVtYmVyLk1JTl9WQUxVRSAqIDIpIHsKICAgICAgd2lkdGggPSAxOwogICAgfQogICAgdGhpcy5TZXRWaWV3KGNlbnRlciwgd2lkdGggKiAoMSArIHBhZGRpbmcpKTsKICB9CgogIC8qKiBAcmV0dXJuIHtTY2VuZX0gdGhyZWUuanMgc2NlbmUgZm9yIHRoZSB2aWV3ZXIuIENhbiBiZSB1c2VkIHRvIGFkZCBjdXN0b20gZW50aXRpZXMgb24gdGhlCiAgICogICAgICBzY2VuZS4gUmVtZW1iZXIgdG8gYXBwbHkgc2NlbmUgb3JpZ2luIGF2YWlsYWJsZSB2aWEgR2V0T3JpZ2luKCkgbWV0aG9kLgogICAqLwogIEdldFNjZW5lKCkgewogICAgcmV0dXJuIHRoaXMuc2NlbmU7CiAgfQoKICAvKiogQHJldHVybiB7T3J0aG9ncmFwaGljQ2FtZXJhfSB0aHJlZS5qcyBjYW1lcmEgZm9yIHRoZSB2aWV3ZXIuICovCiAgR2V0Q2FtZXJhKCkgewogICAgcmV0dXJuIHRoaXMuY2FtZXJhOwogIH0KCiAgLyoqIEByZXR1cm4ge1ZlY3RvcjJ9IFNjZW5lIG9yaWdpbiBpbiBnbG9iYWwgZHJhd2luZyBjb29yZGluYXRlcy4gKi8KICBHZXRPcmlnaW4oKSB7CiAgICByZXR1cm4gdGhpcy5vcmlnaW47CiAgfQoKICAvKioKICAgKiBAcmV0dXJuIHs/e21heFg6IG51bWJlciwgbWF4WTogbnVtYmVyLCBtaW5YOiBudW1iZXIsIG1pblk6IG51bWJlcn19IFNjZW5lIGJvdW5kcyBpbiBtb2RlbAogICAqICAgICAgc3BhY2UgY29vcmRpbmF0ZXMuIE51bGwgaWYgZW1wdHkgc2NlbmUuCiAgICovCiAgR2V0Qm91bmRzKCkgewogICAgcmV0dXJuIHRoaXMuYm91bmRzOwogIH0KCiAgLyoqIFN1YnNjcmliZSB0byB0aGUgc3BlY2lmaWVkIGV2ZW50LiBUaGUgZm9sbG93aW5nIGV2ZW50cyBhcmUgZGVmaW5lZDoKICAgKiAgKiAibG9hZGVkIiAtIG5ldyBzY2VuZSBsb2FkZWQuCiAgICogICogImNsZWFyZWQiIC0gY3VycmVudCBzY2VuZSBjbGVhcmVkLgogICAqICAqICJkZXN0cm95ZWQiIC0gdmlld2VyIGluc3RhbmNlIGRlc3Ryb3llZC4KICAgKiAgKiAicmVzaXplZCIgLSB2aWV3cG9ydCBzaXplIGNoYW5nZWQuIERldGFpbHM6IHt3aWR0aCwgaGVpZ2h0fQogICAqICAqICJwb2ludGVyZG93biIgLSBEZXRhaWxzOiB7ZG9tRXZlbnQsIHBvc2l0aW9uOnt4LHl9fSwgcG9zaXRpb24gaXMgaW4gc2NlbmUgY29vcmRpbmF0ZXMuCiAgICogICogInBvaW50ZXJ1cCIKICAgKiAgKiAidmlld0NoYW5nZWQiCiAgICogICogIm1lc3NhZ2UiIC0gU29tZSBtZXNzYWdlIGZyb20gdGhlIHZpZXdlci4ge21lc3NhZ2U6IHN0cmluZywgbGV2ZWw6IHN0cmluZ30uCiAgICoKICAgKiBAcGFyYW0gZXZlbnROYW1lIHtzdHJpbmd9CiAgICogQHBhcmFtIGV2ZW50SGFuZGxlciB7ZnVuY3Rpb259IEFjY2VwdHMgZXZlbnQgb2JqZWN0LgogICAqLwogIFN1YnNjcmliZShldmVudE5hbWUsIGV2ZW50SGFuZGxlcikgewogICAgdGhpcy5fRW5zdXJlUmVuZGVyZXIoKTsKICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoRVZFTlRfTkFNRV9QUkVGSVggKyBldmVudE5hbWUsIGV2ZW50SGFuZGxlcik7CiAgfQoKICAvKiogVW5zdWJzY3JpYmUgZnJvbSBwcmV2aW91c2x5IHN1YnNjcmliZWQgZXZlbnQuIFRoZSBhcmd1bWVudHMgc2hvdWxkIG1hdGNoIHByZXZpb3VzCiAgICogU3Vic2NyaWJlKCkgY2FsbC4KICAgKgogICAqIEBwYXJhbSBldmVudE5hbWUge3N0cmluZ30KICAgKiBAcGFyYW0gZXZlbnRIYW5kbGVyIHtmdW5jdGlvbn0KICAgKi8KICBVbnN1YnNjcmliZShldmVudE5hbWUsIGV2ZW50SGFuZGxlcikgewogICAgdGhpcy5fRW5zdXJlUmVuZGVyZXIoKTsKICAgIHRoaXMuY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoRVZFTlRfTkFNRV9QUkVGSVggKyBldmVudE5hbWUsIGV2ZW50SGFuZGxlcik7CiAgfQoKICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgX0Vuc3VyZVJlbmRlcmVyKCkgewogICAgaWYgKCF0aGlzLkhhc1JlbmRlcmVyKCkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJXZWJHTCByZW5kZXJlciBub3QgYXZhaWxhYmxlLiAiICsgIlByb2JhYmxlIFdlYkdMIGNvbnRleHQgbG9zcywgdHJ5IHJlZnJlc2hpbmcgdGhlIHBhZ2UuIik7CiAgICB9CiAgfQogIF9DcmVhdGVDb250cm9scygpIHsKICAgIGNvbnN0IGNvbnRyb2xzID0gdGhpcy5jb250cm9scyA9IG5ldyBPcmJpdENvbnRyb2xzKHRoaXMuY2FtZXJhLCB0aGlzLmNhbnZhcyk7CiAgICBjb250cm9scy5lbmFibGVSb3RhdGUgPSBmYWxzZTsKICAgIGNvbnRyb2xzLm1vdXNlQnV0dG9ucyA9IHsKICAgICAgTEVGVDogdGhyZWUuTU9VU0UuUEFOLAogICAgICBNSURETEU6IHRocmVlLk1PVVNFLkRPTExZCiAgICB9OwogICAgY29udHJvbHMudG91Y2hlcyA9IHsKICAgICAgT05FOiB0aHJlZS5UT1VDSC5QQU4sCiAgICAgIFRXTzogdGhyZWUuVE9VQ0guRE9MTFlfUEFOCiAgICB9OwogICAgY29udHJvbHMuem9vbVNwZWVkID0gMzsKICAgIGNvbnRyb2xzLm1vdXNlWm9vbVNwZWVkRmFjdG9yID0gMC4wNTsKICAgIGNvbnRyb2xzLnRhcmdldCA9IG5ldyB0aHJlZS5WZWN0b3IzKHRoaXMuY2FtZXJhLnBvc2l0aW9uLngsIHRoaXMuY2FtZXJhLnBvc2l0aW9uLnksIDApOwogICAgY29udHJvbHMuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKCkgPT4gewogICAgICB0aGlzLl9FbWl0KCJ2aWV3Q2hhbmdlZCIpOwogICAgICB0aGlzLlJlbmRlcigpOwogICAgfSk7CiAgICBjb250cm9scy51cGRhdGUoKTsKICB9CiAgX0VtaXQoZXZlbnROYW1lLCBkYXRhID0gbnVsbCkgewogICAgdGhpcy5jYW52YXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoRVZFTlRfTkFNRV9QUkVGSVggKyBldmVudE5hbWUsIHsKICAgICAgZGV0YWlsOiBkYXRhCiAgICB9KSk7CiAgfQogIF9NZXNzYWdlKG1lc3NhZ2UsIGxldmVsID0gTWVzc2FnZUxldmVsLklORk8pIHsKICAgIHRoaXMuX0VtaXQoIm1lc3NhZ2UiLCB7CiAgICAgIG1lc3NhZ2UsCiAgICAgIGxldmVsCiAgICB9KTsKICB9CiAgX09uUG9pbnRlckV2ZW50KGUpIHsKICAgIGNvbnN0IGNhbnZhc1JlY3QgPSBlLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IGNhbnZhc0Nvb3JkID0gewogICAgICB4OiBlLmNsaWVudFggLSBjYW52YXNSZWN0LmxlZnQsCiAgICAgIHk6IGUuY2xpZW50WSAtIGNhbnZhc1JlY3QudG9wCiAgICB9OwogICAgdGhpcy5fRW1pdChlLnR5cGUsIHsKICAgICAgZG9tRXZlbnQ6IGUsCiAgICAgIGNhbnZhc0Nvb3JkLAogICAgICBwb3NpdGlvbjogdGhpcy5fQ2FudmFzVG9TY2VuZUNvb3JkKGNhbnZhc0Nvb3JkLngsIGNhbnZhc0Nvb3JkLnkpCiAgICB9KTsKICB9CgogIC8qKiBAcmV0dXJuIHt7eCx5fX0gU2NlbmUgY29vcmRpbmF0ZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBzcGVjaWZpZWQgY2FudmFzIHBpeGVsIGNvb3JkaW5hdGVzLiAqLwogIF9DYW52YXNUb1NjZW5lQ29vcmQoeCwgeSkgewogICAgY29uc3QgdiA9IG5ldyB0aHJlZS5WZWN0b3IzKHggKiAyIC8gdGhpcy5jYW52YXNXaWR0aCAtIDEsIC15ICogMiAvIHRoaXMuY2FudmFzSGVpZ2h0ICsgMSwgMSkudW5wcm9qZWN0KHRoaXMuY2FtZXJhKTsKICAgIHJldHVybiB7CiAgICAgIHg6IHYueCwKICAgICAgeTogdi55CiAgICB9OwogIH0KICBfT25SZXNpemUoZW50cnkpIHsKICAgIHRoaXMuU2V0U2l6ZShNYXRoLmZsb29yKGVudHJ5LmNvbnRlbnRSZWN0LndpZHRoKSwgTWF0aC5mbG9vcihlbnRyeS5jb250ZW50UmVjdC5oZWlnaHQpKTsKICB9CiAgX0xvYWRCYXRjaChzY2VuZSwgYmF0Y2gpIHsKICAgIGlmIChiYXRjaC5rZXkuYmxvY2tOYW1lICE9PSBudWxsICYmIGJhdGNoLmtleS5nZW9tZXRyeVR5cGUgIT09IEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5CTE9DS19JTlNUQU5DRSAmJiBiYXRjaC5rZXkuZ2VvbWV0cnlUeXBlICE9PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRfSU5TVEFOQ0UpIHsKICAgICAgLyogQmxvY2sgZGVmaW5pdGlvbi4gKi8KICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3Qgb2JqZWN0cyA9IG5ldyBCYXRjaCh0aGlzLCBzY2VuZSwgYmF0Y2gpLkNyZWF0ZU9iamVjdHMoKTsKICAgIGNvbnN0IGxheWVyID0gdGhpcy5sYXllcnMuZ2V0KGJhdGNoLmtleS5sYXllck5hbWUpOwogICAgZm9yIChjb25zdCBvYmogb2Ygb2JqZWN0cykgewogICAgICB0aGlzLnNjZW5lLmFkZChvYmopOwogICAgICBpZiAobGF5ZXIpIHsKICAgICAgICBsYXllci5QdXNoT2JqZWN0KG9iaik7CiAgICAgIH0KICAgIH0KICB9CiAgX0dldFNpbXBsZUNvbG9yTWF0ZXJpYWwoY29sb3IsIGluc3RhbmNlVHlwZSA9IEluc3RhbmNlVHlwZS5OT05FKSB7CiAgICBjb25zdCBrZXkgPSBuZXcgTWF0ZXJpYWxLZXkoaW5zdGFuY2VUeXBlLCBudWxsLCBjb2xvciwgMCk7CiAgICBsZXQgZW50cnkgPSB0aGlzLm1hdGVyaWFscy5maW5kKHsKICAgICAga2V5CiAgICB9KTsKICAgIGlmIChlbnRyeSAhPT0gbnVsbCkgewogICAgICByZXR1cm4gZW50cnkubWF0ZXJpYWw7CiAgICB9CiAgICBlbnRyeSA9IHsKICAgICAga2V5LAogICAgICBtYXRlcmlhbDogdGhpcy5fQ3JlYXRlU2ltcGxlQ29sb3JNYXRlcmlhbEluc3RhbmNlKGNvbG9yLCBpbnN0YW5jZVR5cGUpCiAgICB9OwogICAgdGhpcy5tYXRlcmlhbHMuaW5zZXJ0KGVudHJ5KTsKICAgIHJldHVybiBlbnRyeS5tYXRlcmlhbDsKICB9CiAgX0NyZWF0ZVNpbXBsZUNvbG9yTWF0ZXJpYWwoaW5zdGFuY2VUeXBlID0gSW5zdGFuY2VUeXBlLk5PTkUpIHsKICAgIGNvbnN0IHNoYWRlcnMgPSB0aGlzLl9HZW5lcmF0ZVNoYWRlcnMoaW5zdGFuY2VUeXBlLCBmYWxzZSk7CiAgICByZXR1cm4gbmV3IHRocmVlLlJhd1NoYWRlck1hdGVyaWFsKHsKICAgICAgdW5pZm9ybXM6IHsKICAgICAgICBjb2xvcjogewogICAgICAgICAgdmFsdWU6IG5ldyB0aHJlZS5Db2xvcigweGZmMDBmZikKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZlcnRleFNoYWRlcjogc2hhZGVycy52ZXJ0ZXgsCiAgICAgIGZyYWdtZW50U2hhZGVyOiBzaGFkZXJzLmZyYWdtZW50LAogICAgICBkZXB0aFRlc3Q6IGZhbHNlLAogICAgICBkZXB0aFdyaXRlOiBmYWxzZSwKICAgICAgZ2xzbFZlcnNpb246IHRocmVlLkdMU0wzLAogICAgICBzaWRlOiB0aHJlZS5Eb3VibGVTaWRlCiAgICB9KTsKICB9CgogIC8qKiBAcGFyYW0gY29sb3Ige251bWJlcn0gQ29sb3IgUkdCIG51bWVyaWMgdmFsdWUuCiAgICogQHBhcmFtIGluc3RhbmNlVHlwZSB7bnVtYmVyfQogICAqLwogIF9DcmVhdGVTaW1wbGVDb2xvck1hdGVyaWFsSW5zdGFuY2UoY29sb3IsIGluc3RhbmNlVHlwZSA9IEluc3RhbmNlVHlwZS5OT05FKSB7CiAgICBjb25zdCBzcmMgPSB0aGlzLnNpbXBsZUNvbG9yTWF0ZXJpYWxbaW5zdGFuY2VUeXBlXTsKICAgIC8qIFNob3VsZCByZXVzZSBjb21waWxlZCBzaGFkZXJzLiAqLwogICAgY29uc3QgbSA9IHNyYy5jbG9uZSgpOwogICAgbS51bmlmb3Jtcy5jb2xvciA9IHsKICAgICAgdmFsdWU6IG5ldyB0aHJlZS5Db2xvcihjb2xvcikKICAgIH07CiAgICByZXR1cm4gbTsKICB9CiAgX0dldFNpbXBsZVBvaW50TWF0ZXJpYWwoY29sb3IsIGluc3RhbmNlVHlwZSA9IEluc3RhbmNlVHlwZS5OT05FKSB7CiAgICBjb25zdCBrZXkgPSBuZXcgTWF0ZXJpYWxLZXkoaW5zdGFuY2VUeXBlLCBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRTLCBjb2xvciwgMCk7CiAgICBsZXQgZW50cnkgPSB0aGlzLm1hdGVyaWFscy5maW5kKHsKICAgICAga2V5CiAgICB9KTsKICAgIGlmIChlbnRyeSAhPT0gbnVsbCkgewogICAgICByZXR1cm4gZW50cnkubWF0ZXJpYWw7CiAgICB9CiAgICBlbnRyeSA9IHsKICAgICAga2V5LAogICAgICBtYXRlcmlhbDogdGhpcy5fQ3JlYXRlU2ltcGxlUG9pbnRNYXRlcmlhbEluc3RhbmNlKGNvbG9yLCB0aGlzLm9wdGlvbnMucG9pbnRTaXplLCBpbnN0YW5jZVR5cGUpCiAgICB9OwogICAgdGhpcy5tYXRlcmlhbHMuaW5zZXJ0KGVudHJ5KTsKICAgIHJldHVybiBlbnRyeS5tYXRlcmlhbDsKICB9CiAgX0NyZWF0ZVNpbXBsZVBvaW50TWF0ZXJpYWwoaW5zdGFuY2VUeXBlID0gSW5zdGFuY2VUeXBlLk5PTkUpIHsKICAgIGNvbnN0IHNoYWRlcnMgPSB0aGlzLl9HZW5lcmF0ZVNoYWRlcnMoaW5zdGFuY2VUeXBlLCB0cnVlKTsKICAgIHJldHVybiBuZXcgdGhyZWUuUmF3U2hhZGVyTWF0ZXJpYWwoewogICAgICB1bmlmb3JtczogewogICAgICAgIGNvbG9yOiB7CiAgICAgICAgICB2YWx1ZTogbmV3IHRocmVlLkNvbG9yKDB4ZmYwMGZmKQogICAgICAgIH0sCiAgICAgICAgcG9pbnRTaXplOiB7CiAgICAgICAgICB2YWx1ZTogMgogICAgICAgIH0KICAgICAgfSwKICAgICAgdmVydGV4U2hhZGVyOiBzaGFkZXJzLnZlcnRleCwKICAgICAgZnJhZ21lbnRTaGFkZXI6IHNoYWRlcnMuZnJhZ21lbnQsCiAgICAgIGRlcHRoVGVzdDogZmFsc2UsCiAgICAgIGRlcHRoV3JpdGU6IGZhbHNlLAogICAgICBnbHNsVmVyc2lvbjogdGhyZWUuR0xTTDMKICAgIH0pOwogIH0KCiAgLyoqIEBwYXJhbSBjb2xvciB7bnVtYmVyfSBDb2xvciBSR0IgbnVtZXJpYyB2YWx1ZS4KICAgKiBAcGFyYW0gc2l6ZSB7bnVtYmVyfSBSYXN0ZXJpemVkIHBvaW50IHNpemUgaW4gcGl4ZWxzLgogICAqIEBwYXJhbSBpbnN0YW5jZVR5cGUge251bWJlcn0KICAgKi8KICBfQ3JlYXRlU2ltcGxlUG9pbnRNYXRlcmlhbEluc3RhbmNlKGNvbG9yLCBzaXplID0gMiwgaW5zdGFuY2VUeXBlID0gSW5zdGFuY2VUeXBlLk5PTkUpIHsKICAgIGNvbnN0IHNyYyA9IHRoaXMuc2ltcGxlUG9pbnRNYXRlcmlhbFtpbnN0YW5jZVR5cGVdOwogICAgLyogU2hvdWxkIHJldXNlIGNvbXBpbGVkIHNoYWRlcnMuICovCiAgICBjb25zdCBtID0gc3JjLmNsb25lKCk7CiAgICBtLnVuaWZvcm1zLmNvbG9yID0gewogICAgICB2YWx1ZTogbmV3IHRocmVlLkNvbG9yKGNvbG9yKQogICAgfTsKICAgIG0udW5pZm9ybXMuc2l6ZSA9IHsKICAgICAgdmFsdWU6IHNpemUKICAgIH07CiAgICByZXR1cm4gbTsKICB9CiAgX0dlbmVyYXRlU2hhZGVycyhpbnN0YW5jZVR5cGUsIHBvaW50U2l6ZSkgewogICAgY29uc3QgZnVsbEluc3RhbmNlQXR0ciA9IGluc3RhbmNlVHlwZSA9PT0gSW5zdGFuY2VUeXBlLkZVTEwgPyBgCiAgICAgICAgICAgIC8qIEZpcnN0IHJvdy4gKi8KICAgICAgICAgICAgaW4gdmVjMyBpbnN0YW5jZVRyYW5zZm9ybTA7CiAgICAgICAgICAgIC8qIFNlY29uZCByb3cuICovCiAgICAgICAgICAgIGluIHZlYzMgaW5zdGFuY2VUcmFuc2Zvcm0xOwogICAgICAgICAgICBgIDogIiI7CiAgICBjb25zdCBmdWxsSW5zdGFuY2VUcmFuc2Zvcm0gPSBpbnN0YW5jZVR5cGUgPT09IEluc3RhbmNlVHlwZS5GVUxMID8gYAogICAgICAgICAgICBwb3MueHkgPSBtYXQyKGluc3RhbmNlVHJhbnNmb3JtMFswXSwgaW5zdGFuY2VUcmFuc2Zvcm0xWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlVHJhbnNmb3JtMFsxXSwgaW5zdGFuY2VUcmFuc2Zvcm0xWzFdKSAqIHBvcy54eSArCiAgICAgICAgICAgICAgICAgICAgIHZlYzIoaW5zdGFuY2VUcmFuc2Zvcm0wWzJdLCBpbnN0YW5jZVRyYW5zZm9ybTFbMl0pOwogICAgICAgICAgICBgIDogIiI7CiAgICBjb25zdCBwb2ludEluc3RhbmNlQXR0ciA9IGluc3RhbmNlVHlwZSA9PT0gSW5zdGFuY2VUeXBlLlBPSU5UID8gYAogICAgICAgICAgICBpbiB2ZWMyIGluc3RhbmNlVHJhbnNmb3JtOwogICAgICAgICAgICBgIDogIiI7CiAgICBjb25zdCBwb2ludEluc3RhbmNlVHJhbnNmb3JtID0gaW5zdGFuY2VUeXBlID09PSBJbnN0YW5jZVR5cGUuUE9JTlQgPyBgCiAgICAgICAgICAgIHBvcy54eSArPSBpbnN0YW5jZVRyYW5zZm9ybTsKICAgICAgICAgICAgYCA6ICIiOwogICAgY29uc3QgcG9pbnRTaXplVW5pZm9ybSA9IHBvaW50U2l6ZSA/ICJ1bmlmb3JtIGZsb2F0IHBvaW50U2l6ZTsiIDogIiI7CiAgICBjb25zdCBwb2ludFNpemVBc3NpZ21lbnQgPSBwb2ludFNpemUgPyAiZ2xfUG9pbnRTaXplID0gcG9pbnRTaXplOyIgOiAiIjsKICAgIHJldHVybiB7CiAgICAgIHZlcnRleDogYAoKICAgICAgICAgICAgcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwogICAgICAgICAgICBwcmVjaXNpb24gaGlnaHAgaW50OwogICAgICAgICAgICBpbiB2ZWMyIHBvc2l0aW9uOwogICAgICAgICAgICAke2Z1bGxJbnN0YW5jZUF0dHJ9CiAgICAgICAgICAgICR7cG9pbnRJbnN0YW5jZUF0dHJ9CiAgICAgICAgICAgIHVuaWZvcm0gbWF0NCBtb2RlbFZpZXdNYXRyaXg7CiAgICAgICAgICAgIHVuaWZvcm0gbWF0NCBwcm9qZWN0aW9uTWF0cml4OwogICAgICAgICAgICAke3BvaW50U2l6ZVVuaWZvcm19CgogICAgICAgICAgICB2b2lkIG1haW4oKSB7CiAgICAgICAgICAgICAgICB2ZWM0IHBvcyA9IHZlYzQocG9zaXRpb24sIDAuMCwgMS4wKTsKICAgICAgICAgICAgICAgICR7ZnVsbEluc3RhbmNlVHJhbnNmb3JtfQogICAgICAgICAgICAgICAgJHtwb2ludEluc3RhbmNlVHJhbnNmb3JtfQogICAgICAgICAgICAgICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogcG9zOwogICAgICAgICAgICAgICAgJHtwb2ludFNpemVBc3NpZ21lbnR9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYCwKICAgICAgZnJhZ21lbnQ6IGAKCiAgICAgICAgICAgIHByZWNpc2lvbiBoaWdocCBmbG9hdDsKICAgICAgICAgICAgcHJlY2lzaW9uIGhpZ2hwIGludDsKICAgICAgICAgICAgdW5pZm9ybSB2ZWMzIGNvbG9yOwogICAgICAgICAgICBvdXQgdmVjNCBmcmFnQ29sb3I7CgogICAgICAgICAgICB2b2lkIG1haW4oKSB7CiAgICAgICAgICAgICAgICBmcmFnQ29sb3IgPSB2ZWM0KGNvbG9yLCAxLjApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGAKICAgIH07CiAgfQoKICAvKiogRW5zdXJlIHRoZSBjb2xvciBpcyBjb250cmFzdCBlbm91Z2ggd2l0aCBjdXJyZW50IGJhY2tncm91bmQgY29sb3IuCiAgICogQHBhcmFtIGNvbG9yIHtudW1iZXJ9IFJHQiB2YWx1ZS4KICAgKiBAcmV0dXJuIHtudW1iZXJ9IFJHQiB2YWx1ZSB0byB1c2UgZm9yIHJlbmRlcmluZy4KICAgKi8KICBfVHJhbnNmb3JtQ29sb3IoY29sb3IpIHsKICAgIGlmICghdGhpcy5vcHRpb25zLmNvbG9yQ29ycmVjdGlvbiAmJiAhdGhpcy5vcHRpb25zLmJsYWNrV2hpdGVJbnZlcnNpb24pIHsKICAgICAgcmV0dXJuIGNvbG9yOwogICAgfQogICAgLyogSnVzdCBibGFjayBhbmQgd2hpdGUgaW52ZXJzaW9uLiAqLwogICAgY29uc3QgYmtnTHVtID0gTHVtaW5hbmNlKHRoaXMuY2xlYXJDb2xvcik7CiAgICBpZiAoY29sb3IgPT09IDB4ZmZmZmZmICYmIGJrZ0x1bSA+PSAwLjgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBpZiAoY29sb3IgPT09IDAgJiYgYmtnTHVtIDw9IDAuMikgewogICAgICByZXR1cm4gMHhmZmZmZmY7CiAgICB9CiAgICBpZiAoIXRoaXMub3B0aW9ucy5jb2xvckNvcnJlY3Rpb24pIHsKICAgICAgcmV0dXJuIGNvbG9yOwogICAgfQogICAgY29uc3QgZmdMdW0gPSBMdW1pbmFuY2UoY29sb3IpOwogICAgY29uc3QgTUlOX1RBUkdFVF9SQVRJTyA9IDEuNTsKICAgIGNvbnN0IGNvbnRyYXN0ID0gQ29udHJhc3RSYXRpbyhjb2xvciwgdGhpcy5jbGVhckNvbG9yKTsKICAgIGNvbnN0IGRpZmYgPSBjb250cmFzdCA+PSAxID8gY29udHJhc3QgOiAxIC8gY29udHJhc3Q7CiAgICBpZiAoZGlmZiA8IE1JTl9UQVJHRVRfUkFUSU8pIHsKICAgICAgbGV0IHRhcmdldEx1bTsKICAgICAgaWYgKGJrZ0x1bSA+IDAuNSkgewogICAgICAgIHRhcmdldEx1bSA9IGJrZ0x1bSAvIDI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0THVtID0gYmtnTHVtICogMjsKICAgICAgfQogICAgICBpZiAodGFyZ2V0THVtID4gZmdMdW0pIHsKICAgICAgICBjb2xvciA9IExpZ2h0ZW4oY29sb3IsIHRhcmdldEx1bSAvIGZnTHVtKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2xvciA9IERhcmtlbihjb2xvciwgZmdMdW0gLyB0YXJnZXRMdW0pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gY29sb3I7CiAgfQp9CkR4ZlZpZXdlci5NZXNzYWdlTGV2ZWwgPSBNZXNzYWdlTGV2ZWw7CkR4ZlZpZXdlci5EZWZhdWx0T3B0aW9ucyA9IHsKICBjYW52YXNXaWR0aDogNDAwLAogIGNhbnZhc0hlaWdodDogMzAwLAogIC8qKiBBdXRvbWF0aWNhbGx5IHJlc2l6ZSBjYW52YXMgd2hlbiB0aGUgY29udGFpbmVyIGlzIHJlc2l6ZWQuIFRoaXMgb3B0aW9ucyB1dGlsaXplcwogICAqICBSZXNpemVPYnNlcnZlciBBUEkgd2hpY2ggaXMgc3RpbGwgbm90IGZ1bGx5IHN0YW5kYXJkaXplZC4gVGhlIHNwZWNpZmllZCBjYW52YXMgc2l6ZSBpcwogICAqICBpZ25vcmVkIGlmIHRoZSBvcHRpb24gaXMgZW5hYmxlZC4KICAgKi8KICBhdXRvUmVzaXplOiBmYWxzZSwKICAvKiogRnJhbWUgYnVmZmVyIGNsZWFyIGNvbG9yLiAqLwogIGNsZWFyQ29sb3I6IG5ldyB0aHJlZS5Db2xvcigiIzAwMCIpLAogIC8qKiBGcmFtZSBidWZmZXIgY2xlYXIgY29sb3IgYWxwaGEgdmFsdWUuICovCiAgY2xlYXJBbHBoYTogMS4wLAogIC8qKiBVc2UgYWxwaGEgY2hhbm5lbCBpbiBhIGZyYW1lYnVmZmVyLiAqLwogIGNhbnZhc0FscGhhOiBmYWxzZSwKICAvKiogQXNzdW1lIHByZW11bHRpcGxpZWQgYWxwaGEgaW4gYSBmcmFtZWJ1ZmZlci4gKi8KICBjYW52YXNQcmVtdWx0aXBsaWVkQWxwaGE6IHRydWUsCiAgLyoqIFVzZSBhbnRpYWxpYXNpbmcuIE1heSBkZWdyYWRlIHBlcmZvcm1hbmNlIG9uIHBvb3IgaGFyZHdhcmUuICovCiAgYW50aWFsaWFzOiB0cnVlLAogIC8qKiBDb3JyZWN0IGVudGl0aWVzIGNvbG9ycyB0byBlbnN1cmUgdGhhdCB0aGV5IGFyZSBhbHdheXMgdmlzaWJsZSB3aXRoIHRoZSBjdXJyZW50IGJhY2tncm91bmQKICAgKiBjb2xvci4KICAgKi8KICBjb2xvckNvcnJlY3Rpb246IGZhbHNlLAogIC8qKiBTaW1wbGVyIHZlcnNpb24gb2YgY29sb3JDb3JyZWN0aW9uIC0ganVzdCBpbnZlcnQgcHVyZSB3aGl0ZSBvciBibGFjayBlbnRpdGllcyBpZiB0aGV5IGFyZQogICAqIGludmlzaWJsZSBvbiBjdXJyZW50IGJhY2tncm91bmQgY29sb3IuCiAgICovCiAgYmxhY2tXaGl0ZUludmVyc2lvbjogdHJ1ZSwKICAvKiogU2l6ZSBpbiBwaXhlbHMgZm9yIHJhc3Rlcml6ZWQgcG9pbnRzIChkb3QgbWFyaykuICovCiAgcG9pbnRTaXplOiAyLAogIC8qKiBTY2VuZSBnZW5lcmF0aW9uIG9wdGlvbnMuICovCiAgc2NlbmVPcHRpb25zOiBEeGZTY2VuZS5EZWZhdWx0T3B0aW9ucywKICAvKiogUmV0YWluIHRoZSBzaW1wbGUgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgcGFyc2VkIERYRiAtIHdpbGwgY29uc3VtZSBhIGxvdCBvZiBhZGRpdGlvbmFsCiAgICogbWVtb3J5LgogICAqLwogIHJldGFpblBhcnNlZER4ZjogZmFsc2UsCiAgLyoqIFdoZXRoZXIgdG8gcHJlc2VydmUgdGhlIGJ1ZmZlcnMgdW50aWwgbWFudWFsbHkgY2xlYXJlZCBvciBvdmVyd3JpdHRlbi4gKi8KICBwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6IGZhbHNlLAogIC8qKiBFbmNvZGluZyB0byB1c2UgZm9yIGRlY29kaW5nIERYRiBmaWxlIHRleHQgY29udGVudC4gRFhGIGZpbGVzIG5ld2VyIHRoYW4gRFhGIFIyMDA0IChBQzEwMTgpCiAgICogdXNlIFVURi04IGVuY29kaW5nLiBPbGRlciBmaWxlcyB1c2Ugc29tZSBjb2RlIHBhZ2Ugd2hpY2ggaXMgc3BlY2lmaWVkIGluICREV0dDT0RFUEFHRSBoZWFkZXIKICAgKiB2YXJpYWJsZS4gQ3VycmVudGx5IHBhcnNlciBpcyBpbXBsZW1lbnRlZCBpbiBzdWNoIGEgd2F5IHRoYXQgZW5jb2RpbmcgbXVzdCBiZSBzcGVjaWZpZWQKICAgKiBiZWZvcmUgdGhlIGNvbnRlbnQgaXMgcGFyc2VkIHNvIHRoZXJlIGlzIG5vIGNoYW5jZSB0byB1c2UgdGhpcyB2YXJpYWJsZSBkeW5hbWljYWxseS4gVGhpcyBtYXkKICAgKiBiZSBhIHN1YmplY3QgZm9yIGZ1dHVyZSBjaGFuZ2VzLiBUaGUgc3BlY2lmaWVkIHZhbHVlIHNob3VsZCBiZSBzdWl0YWJsZSBmb3IgcGFzc2luZyBhcwogICAqIGBUZXh0RGVjb2RlcmAgY29uc3RydWN0b3IgYGxhYmVsYCBwYXJhbWV0ZXIuCiAgICovCiAgZmlsZUVuY29kaW5nOiAidXRmLTgiCn07CkR4ZlZpZXdlci5TZXR1cFdvcmtlciA9IGZ1bmN0aW9uICgpIHsKICBuZXcgRHhmV29ya2VyKHNlbGYsIHRydWUpOwp9Owpjb25zdCBJbnN0YW5jZVR5cGUgPSBPYmplY3QuZnJlZXplKHsKICAvKiogTm90IGluc3RhbmNlZC4gKi8KICBOT05FOiAwLAogIC8qKiBGdWxsIGFmZmluZSB0cmFuc2Zvcm0gcGVyIGluc3RhbmNlLiAqLwogIEZVTEw6IDEsCiAgLyoqIFBvaW50IGluc3RhbmNlcywgMkQtdHJhbnNsYXRpb24gdmVjdG9yIHBlciBpbnN0YW5jZS4gKi8KICBQT0lOVDogMiwKICAvKiogTnVtYmVyIG9mIHR5cGVzLiAqLwogIE1BWDogMwp9KTsKY2xhc3MgQmF0Y2ggewogIC8qKgogICAqIEBwYXJhbSB2aWV3ZXIge0R4ZlZpZXdlcn0KICAgKiBAcGFyYW0gc2NlbmUgU2VyaWFsaXplZCBzY2VuZS4KICAgKiBAcGFyYW0gYmF0Y2ggU2VyaWFsaXplZCBzY2VuZSBiYXRjaC4KICAgKi8KICBjb25zdHJ1Y3Rvcih2aWV3ZXIsIHNjZW5lLCBiYXRjaCkgewogICAgdGhpcy52aWV3ZXIgPSB2aWV3ZXI7CiAgICB0aGlzLmtleSA9IGJhdGNoLmtleTsKICAgIGlmIChiYXRjaC5oYXNPd25Qcm9wZXJ0eSgidmVydGljZXNPZmZzZXQiKSkgewogICAgICBjb25zdCB2ZXJ0aWNlc0FycmF5ID0gbmV3IEZsb2F0MzJBcnJheShzY2VuZS52ZXJ0aWNlcywgYmF0Y2gudmVydGljZXNPZmZzZXQgKiBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQsIGJhdGNoLnZlcnRpY2VzU2l6ZSk7CiAgICAgIGlmICh0aGlzLmtleS5nZW9tZXRyeVR5cGUgIT09IEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5QT0lOVF9JTlNUQU5DRSB8fCBzY2VuZS5wb2ludFNoYXBlSGFzRG90KSB7CiAgICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyB0aHJlZS5CdWZmZXJBdHRyaWJ1dGUodmVydGljZXNBcnJheSwgMik7CiAgICAgIH0KICAgICAgaWYgKHRoaXMua2V5Lmdlb21ldHJ5VHlwZSA9PT0gQmF0Y2hpbmdLZXkuR2VvbWV0cnlUeXBlLlBPSU5UX0lOU1RBTkNFKSB7CiAgICAgICAgdGhpcy50cmFuc2Zvcm1zID0gbmV3IHRocmVlLkluc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlc0FycmF5LCAyKTsKICAgICAgfQogICAgfQogICAgaWYgKGJhdGNoLmhhc093blByb3BlcnR5KCJjaHVua3MiKSkgewogICAgICB0aGlzLmNodW5rcyA9IFtdOwogICAgICBmb3IgKGNvbnN0IHJhd0NodW5rIG9mIGJhdGNoLmNodW5rcykgewogICAgICAgIGNvbnN0IHZlcnRpY2VzQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KHNjZW5lLnZlcnRpY2VzLCByYXdDaHVuay52ZXJ0aWNlc09mZnNldCAqIEZsb2F0MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVCwgcmF3Q2h1bmsudmVydGljZXNTaXplKTsKICAgICAgICBjb25zdCBpbmRpY2VzQXJyYXkgPSBuZXcgVWludDE2QXJyYXkoc2NlbmUuaW5kaWNlcywgcmF3Q2h1bmsuaW5kaWNlc09mZnNldCAqIFVpbnQxNkFycmF5LkJZVEVTX1BFUl9FTEVNRU5ULCByYXdDaHVuay5pbmRpY2VzU2l6ZSk7CiAgICAgICAgdGhpcy5jaHVua3MucHVzaCh7CiAgICAgICAgICB2ZXJ0aWNlczogbmV3IHRocmVlLkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlc0FycmF5LCAyKSwKICAgICAgICAgIGluZGljZXM6IG5ldyB0aHJlZS5CdWZmZXJBdHRyaWJ1dGUoaW5kaWNlc0FycmF5LCAxKQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBpZiAoYmF0Y2guaGFzT3duUHJvcGVydHkoInRyYW5zZm9ybXNPZmZzZXQiKSkgewogICAgICBjb25zdCB0cmFuc2Zvcm1zQXJyYXkgPSBuZXcgRmxvYXQzMkFycmF5KHNjZW5lLnRyYW5zZm9ybXMsIGJhdGNoLnRyYW5zZm9ybXNPZmZzZXQgKiBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQsIGJhdGNoLnRyYW5zZm9ybXNTaXplKTsKICAgICAgLyogRWFjaCB0cmFuc2Zvcm0gaXMgM3gyIG1hdHJpeCB3aGljaCBpcyBzcGxpdCBpbnRvIHR3byAzRCB2ZWN0b3JzIHdoaWNoIHdpbGwgb2NjdXB5IHR3bwogICAgICAgKiBhdHRyaWJ1dGUgc2xvdHMuCiAgICAgICAqLwogICAgICBjb25zdCBidWYgPSBuZXcgdGhyZWUuSW5zdGFuY2VkSW50ZXJsZWF2ZWRCdWZmZXIodHJhbnNmb3Jtc0FycmF5LCA2KTsKICAgICAgdGhpcy50cmFuc2Zvcm1zMCA9IG5ldyB0aHJlZS5JbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZShidWYsIDMsIDApOwogICAgICB0aGlzLnRyYW5zZm9ybXMxID0gbmV3IHRocmVlLkludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKGJ1ZiwgMywgMyk7CiAgICB9CiAgICBpZiAodGhpcy5rZXkuZ2VvbWV0cnlUeXBlID09PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuQkxPQ0tfSU5TVEFOQ0UgfHwgdGhpcy5rZXkuZ2VvbWV0cnlUeXBlID09PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRfSU5TVEFOQ0UpIHsKICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLnZpZXdlci5sYXllcnMuZ2V0KHRoaXMua2V5LmxheWVyTmFtZSk7CiAgICAgIGlmIChsYXllcikgewogICAgICAgIHRoaXMubGF5ZXJDb2xvciA9IGxheWVyLmNvbG9yOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubGF5ZXJDb2xvciA9IDA7CiAgICAgIH0KICAgIH0KICB9CiAgR2V0SW5zdGFuY2VUeXBlKCkgewogICAgc3dpdGNoICh0aGlzLmtleS5nZW9tZXRyeVR5cGUpIHsKICAgICAgY2FzZSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuQkxPQ0tfSU5TVEFOQ0U6CiAgICAgICAgcmV0dXJuIEluc3RhbmNlVHlwZS5GVUxMOwogICAgICBjYXNlIEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5QT0lOVF9JTlNUQU5DRToKICAgICAgICByZXR1cm4gSW5zdGFuY2VUeXBlLlBPSU5UOwogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBJbnN0YW5jZVR5cGUuTk9ORTsKICAgIH0KICB9CgogIC8qKiBDcmVhdGUgc2NlbmUgb2JqZWN0cyBjb3JyZXNwb25kaW5nIHRvIGJhdGNoIGRhdGEuCiAgICogQHBhcmFtIGluc3RhbmNlQmF0Y2ggez9CYXRjaH0gQmF0Y2ggd2l0aCBpbnN0YW5jZSB0cmFuc2Zvcm0uIE51bGwgZm9yIG5vbi1pbnN0YW5jZWQgb2JqZWN0LgogICAqLwogICpDcmVhdGVPYmplY3RzKGluc3RhbmNlQmF0Y2ggPSBudWxsKSB7CiAgICBpZiAodGhpcy5rZXkuZ2VvbWV0cnlUeXBlID09PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuQkxPQ0tfSU5TVEFOQ0UgfHwgdGhpcy5rZXkuZ2VvbWV0cnlUeXBlID09PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRfSU5TVEFOQ0UpIHsKICAgICAgaWYgKGluc3RhbmNlQmF0Y2ggIT09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgaW5zdGFuY2UgYmF0Y2ggc3BlY2lmaWVkIGZvciBpbnN0YW5jZSBiYXRjaCIpOwogICAgICB9CiAgICAgIHlpZWxkKiB0aGlzLl9DcmVhdGVCbG9ja0luc3RhbmNlT2JqZWN0cygpOwogICAgICByZXR1cm47CiAgICB9CiAgICB5aWVsZCogdGhpcy5fQ3JlYXRlT2JqZWN0cyhpbnN0YW5jZUJhdGNoKTsKICB9CiAgKl9DcmVhdGVPYmplY3RzKGluc3RhbmNlQmF0Y2gpIHsKICAgIHZhciBfaW5zdGFuY2VCYXRjaCRHZXRJbnM7CiAgICBjb25zdCBjb2xvciA9IGluc3RhbmNlQmF0Y2ggPyBpbnN0YW5jZUJhdGNoLl9HZXRJbnN0YW5jZUNvbG9yKHRoaXMua2V5LmNvbG9yKSA6IHRoaXMua2V5LmNvbG9yOwoKICAgIC8vWFhYIGxpbmUgdHlwZQogICAgY29uc3QgbWF0ZXJpYWxGYWN0b3J5ID0gdGhpcy5rZXkuZ2VvbWV0cnlUeXBlID09PSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRTIHx8IHRoaXMua2V5Lmdlb21ldHJ5VHlwZSA9PT0gQmF0Y2hpbmdLZXkuR2VvbWV0cnlUeXBlLlBPSU5UX0lOU1RBTkNFID8gdGhpcy52aWV3ZXIuX0dldFNpbXBsZVBvaW50TWF0ZXJpYWwgOiB0aGlzLnZpZXdlci5fR2V0U2ltcGxlQ29sb3JNYXRlcmlhbDsKICAgIGNvbnN0IG1hdGVyaWFsID0gbWF0ZXJpYWxGYWN0b3J5LmNhbGwodGhpcy52aWV3ZXIsIHRoaXMudmlld2VyLl9UcmFuc2Zvcm1Db2xvcihjb2xvciksIChfaW5zdGFuY2VCYXRjaCRHZXRJbnMgPSBpbnN0YW5jZUJhdGNoID09PSBudWxsIHx8IGluc3RhbmNlQmF0Y2ggPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluc3RhbmNlQmF0Y2guR2V0SW5zdGFuY2VUeXBlKCkpICE9PSBudWxsICYmIF9pbnN0YW5jZUJhdGNoJEdldElucyAhPT0gdm9pZCAwID8gX2luc3RhbmNlQmF0Y2gkR2V0SW5zIDogSW5zdGFuY2VUeXBlLk5PTkUpOwogICAgbGV0IG9iakNvbnN0cnVjdG9yOwogICAgc3dpdGNoICh0aGlzLmtleS5nZW9tZXRyeVR5cGUpIHsKICAgICAgY2FzZSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRTOgogICAgICAvKiBUaGlzIG1ldGhvZCBhbHNvIGNhbGxlZCBmb3IgY3JlYXRpbmcgZG90cyBmb3Igc2hhcGVkIHBvaW50IGluc3RhbmNlcy4gKi8KICAgICAgY2FzZSBCYXRjaGluZ0tleS5HZW9tZXRyeVR5cGUuUE9JTlRfSU5TVEFOQ0U6CiAgICAgICAgb2JqQ29uc3RydWN0b3IgPSB0aHJlZS5Qb2ludHM7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQmF0Y2hpbmdLZXkuR2VvbWV0cnlUeXBlLkxJTkVTOgogICAgICBjYXNlIEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5JTkRFWEVEX0xJTkVTOgogICAgICAgIG9iakNvbnN0cnVjdG9yID0gdGhyZWUuTGluZVNlZ21lbnRzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEJhdGNoaW5nS2V5Lkdlb21ldHJ5VHlwZS5UUklBTkdMRVM6CiAgICAgIGNhc2UgQmF0Y2hpbmdLZXkuR2VvbWV0cnlUeXBlLklOREVYRURfVFJJQU5HTEVTOgogICAgICAgIG9iakNvbnN0cnVjdG9yID0gdGhyZWUuTWVzaDsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuZXhwZWN0ZWQgZ2VvbWV0cnkgdHlwZToiICsgdGhpcy5rZXkuZ2VvbWV0cnlUeXBlKTsKICAgIH0KICAgIGZ1bmN0aW9uIENyZWF0ZU9iamVjdCh2ZXJ0aWNlcywgaW5kaWNlcykgewogICAgICBjb25zdCBnZW9tZXRyeSA9IGluc3RhbmNlQmF0Y2ggPyBuZXcgdGhyZWUuSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkoKSA6IG5ldyB0aHJlZS5CdWZmZXJHZW9tZXRyeSgpOwogICAgICBnZW9tZXRyeS5zZXRBdHRyaWJ1dGUoInBvc2l0aW9uIiwgdmVydGljZXMpOwogICAgICBpbnN0YW5jZUJhdGNoID09PSBudWxsIHx8IGluc3RhbmNlQmF0Y2ggPT09IHZvaWQgMCB8fCBpbnN0YW5jZUJhdGNoLl9TZXRJbnN0YW5jZVRyYW5zZm9ybUF0dHJpYnV0ZShnZW9tZXRyeSk7CiAgICAgIGlmIChpbmRpY2VzKSB7CiAgICAgICAgZ2VvbWV0cnkuc2V0SW5kZXgoaW5kaWNlcyk7CiAgICAgIH0KICAgICAgY29uc3Qgb2JqID0gbmV3IG9iakNvbnN0cnVjdG9yKGdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICAgIG9iai5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7CiAgICAgIG9iai5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7CiAgICAgIHJldHVybiBvYmo7CiAgICB9CiAgICBpZiAodGhpcy5jaHVua3MpIHsKICAgICAgZm9yIChjb25zdCBjaHVuayBvZiB0aGlzLmNodW5rcykgewogICAgICAgIHlpZWxkIENyZWF0ZU9iamVjdChjaHVuay52ZXJ0aWNlcywgY2h1bmsuaW5kaWNlcyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHlpZWxkIENyZWF0ZU9iamVjdCh0aGlzLnZlcnRpY2VzKTsKICAgIH0KICB9CgogIC8qKgogICAqIEBwYXJhbSBnZW9tZXRyeSB7SW5zdGFuY2VkQnVmZmVyR2VvbWV0cnl9CiAgICovCiAgX1NldEluc3RhbmNlVHJhbnNmb3JtQXR0cmlidXRlKGdlb21ldHJ5KSB7CiAgICBpZiAoIWdlb21ldHJ5LmlzSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSBleHBlY3RlZCIpOwogICAgfQogICAgaWYgKHRoaXMua2V5Lmdlb21ldHJ5VHlwZSA9PT0gQmF0Y2hpbmdLZXkuR2VvbWV0cnlUeXBlLlBPSU5UX0lOU1RBTkNFKSB7CiAgICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgiaW5zdGFuY2VUcmFuc2Zvcm0iLCB0aGlzLnRyYW5zZm9ybXMpOwogICAgfSBlbHNlIHsKICAgICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJpbnN0YW5jZVRyYW5zZm9ybTAiLCB0aGlzLnRyYW5zZm9ybXMwKTsKICAgICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCJpbnN0YW5jZVRyYW5zZm9ybTEiLCB0aGlzLnRyYW5zZm9ybXMxKTsKICAgIH0KICB9CiAgKl9DcmVhdGVCbG9ja0luc3RhbmNlT2JqZWN0cygpIHsKICAgIGNvbnN0IGJsb2NrID0gdGhpcy52aWV3ZXIuYmxvY2tzLmdldCh0aGlzLmtleS5ibG9ja05hbWUpOwogICAgaWYgKCFibG9jaykgewogICAgICByZXR1cm47CiAgICB9CiAgICBmb3IgKGNvbnN0IGJhdGNoIG9mIGJsb2NrLmJhdGNoZXMpIHsKICAgICAgeWllbGQqIGJhdGNoLkNyZWF0ZU9iamVjdHModGhpcyk7CiAgICB9CiAgICBpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eSgidmVydGljZXMiKSkgewogICAgICAvKiBEb3RzIGZvciBwb2ludCBzaGFwZXMuICovCiAgICAgIHlpZWxkKiB0aGlzLl9DcmVhdGVPYmplY3RzKCk7CiAgICB9CiAgfQoKICAvKioKICAgKiBAcGFyYW0gZGVmQ29sb3Ige251bWJlcn0gQ29sb3IgdmFsdWUgZm9yIGJsb2NrIGRlZmluaXRpb24gYmF0Y2guCiAgICogQHJldHVybiB7bnVtYmVyfSBSR0IgY29sb3IgdmFsdWUgZm9yIGEgYmxvY2sgaW5zdGFuY2UuCiAgICovCiAgX0dldEluc3RhbmNlQ29sb3IoZGVmQ29sb3IpIHsKICAgIGlmIChkZWZDb2xvciA9PT0gQ29sb3JDb2RlLkJZX0JMT0NLKSB7CiAgICAgIHJldHVybiB0aGlzLmtleS5jb2xvcjsKICAgIH0gZWxzZSBpZiAoZGVmQ29sb3IgPT09IENvbG9yQ29kZS5CWV9MQVlFUikgewogICAgICByZXR1cm4gdGhpcy5sYXllckNvbG9yOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGRlZkNvbG9yOwogICAgfQogIH0KfQpjbGFzcyBMYXllciB7CiAgY29uc3RydWN0b3IobmFtZSwgZGlzcGxheU5hbWUsIGNvbG9yKSB7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5kaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lOwogICAgdGhpcy5jb2xvciA9IGNvbG9yOwogICAgdGhpcy5vYmplY3RzID0gW107CiAgfQogIFB1c2hPYmplY3Qob2JqKSB7CiAgICB0aGlzLm9iamVjdHMucHVzaChvYmopOwogIH0KICBEaXNwb3NlKCkgewogICAgZm9yIChjb25zdCBvYmogb2YgdGhpcy5vYmplY3RzKSB7CiAgICAgIG9iai5nZW9tZXRyeS5kaXNwb3NlKCk7CiAgICB9CiAgICB0aGlzLm9iamVjdHMgPSBudWxsOwogIH0KfQpjbGFzcyBCbG9jayB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmJhdGNoZXMgPSBbXTsKICB9CgogIC8qKiBAcGFyYW0gYmF0Y2gge0JhdGNofSAqLwogIFB1c2hCYXRjaChiYXRjaCkgewogICAgdGhpcy5iYXRjaGVzLnB1c2goYmF0Y2gpOwogIH0KfQoKLyoqIEN1c3RvbSB2aWV3ZXIgZXZlbnQgbmFtZXMgYXJlIHByZWZpeGVkIHdpdGggdGhpcyBzdHJpbmcuICovCmNvbnN0IEVWRU5UX05BTUVfUFJFRklYID0gIl9fZHhmXyI7CgovKiogVHJhbnNmb3JtIHNSR0IgY29sb3IgY29tcG9uZW50IHRvIGxpbmVhciBjb2xvciBzcGFjZS4gKi8KZnVuY3Rpb24gTGluZWFyQ29sb3IoYykgewogIHJldHVybiBjIDw9IDAuMDM5MjggPyBjIC8gMTIuOTIgOiBNYXRoLnBvdygoYyArIDAuMDU1KSAvIDEuMDU1LCAyLjQpOwp9CgovKiogVHJhbnNmb3JtIGxpbmVhciBjb2xvciBjb21wb25lbnQgdG8gc1JHQiBjb2xvciBzcGFjZS4gKi8KZnVuY3Rpb24gU1JnYkNvbG9yKGMpIHsKICByZXR1cm4gYyA8IDAuMDAzID8gYyAqIDEyLjkyIDogTWF0aC5wb3coYywgMSAvIDIuNCkgKiAxLjA1NSAtIDAuMDU1Owp9CgovKiogR2V0IHJlbGF0aXZlIGx1bWluYW5jZSB2YWx1ZSBmb3IgYSBjb2xvci4KICogaHR0cHM6Ly93d3cudzMub3JnL1RSLzIwMDgvUkVDLVdDQUcyMC0yMDA4MTIxMS8jcmVsYXRpdmVsdW1pbmFuY2VkZWYKICogQHBhcmFtIGNvbG9yIHtudW1iZXJ9IFJHQiBjb2xvciB2YWx1ZS4KICogQHJldHVybiB7bnVtYmVyfSBMdW1pbmFuY2UgdmFsdWUgaW4gcmFuZ2UgWzA7IDFdLgogKi8KZnVuY3Rpb24gTHVtaW5hbmNlKGNvbG9yKSB7CiAgY29uc3QgciA9IExpbmVhckNvbG9yKCgoY29sb3IgJiAweGZmMDAwMCkgPj4+IDE2KSAvIDI1NSk7CiAgY29uc3QgZyA9IExpbmVhckNvbG9yKCgoY29sb3IgJiAweGZmMDApID4+PiA4KSAvIDI1NSk7CiAgY29uc3QgYiA9IExpbmVhckNvbG9yKChjb2xvciAmIDB4ZmYpIC8gMjU1KTsKICByZXR1cm4gciAqIDAuMjEyNiArIGcgKiAwLjcxNTIgKyBiICogMC4wNzIyOwp9CgovKioKICogR2V0IGNvbnRyYXN0IHJhdGlvIGZvciBhIGNvbG9yIHBhaXIuCiAqIGh0dHBzOi8vd3d3LnczLm9yZy9UUi8yMDA4L1JFQy1XQ0FHMjAtMjAwODEyMTEvI2NvbnRyYXN0LXJhdGlvZGVmCiAqIEBwYXJhbSBjMQogKiBAcGFyYW0gYzIKICogQHJldHVybiB7bnVtYmVyfSBDb250cmFzdCByYXRpbyBiZXR3ZWVuIHRoZSBjb2xvcnMuIEdyZWF0ZXIgdGhhbiBvbmUgaWYgdGhlIGZpcnN0IGNvbG9yIGNvbG9yIGlzCiAqICBicmlnaHRlciB0aGFuIHRoZSBzZWNvbmQgb25lLgogKi8KZnVuY3Rpb24gQ29udHJhc3RSYXRpbyhjMSwgYzIpIHsKICByZXR1cm4gKEx1bWluYW5jZShjMSkgKyAwLjA1KSAvIChMdW1pbmFuY2UoYzIpICsgMC4wNSk7Cn0KZnVuY3Rpb24gSGxzVG9SZ2IoewogIGgsCiAgbCwKICBzCn0pIHsKICBsZXQgciwgZywgYjsKICBpZiAocyA9PT0gMCkgewogICAgLyogQWNocm9tYXRpYyAqLwogICAgciA9IGcgPSBiID0gbDsKICB9IGVsc2UgewogICAgZnVuY3Rpb24gaHVlMnJnYihwLCBxLCB0KSB7CiAgICAgIGlmICh0IDwgMCkgewogICAgICAgIHQgKz0gMTsKICAgICAgfQogICAgICBpZiAodCA+IDEpIHsKICAgICAgICB0IC09IDE7CiAgICAgIH0KICAgICAgaWYgKHQgPCAxIC8gNikgewogICAgICAgIHJldHVybiBwICsgKHEgLSBwKSAqIDYgKiB0OwogICAgICB9CiAgICAgIGlmICh0IDwgMSAvIDIpIHsKICAgICAgICByZXR1cm4gcTsKICAgICAgfQogICAgICBpZiAodCA8IDIgLyAzKSB7CiAgICAgICAgcmV0dXJuIHAgKyAocSAtIHApICogKDIgLyAzIC0gdCkgKiA2OwogICAgICB9CiAgICAgIHJldHVybiBwOwogICAgfQogICAgY29uc3QgcSA9IGwgPCAwLjUgPyBsICogKDEgKyBzKSA6IGwgKyBzIC0gbCAqIHM7CiAgICBjb25zdCBwID0gMiAqIGwgLSBxOwogICAgciA9IGh1ZTJyZ2IocCwgcSwgaCArIDEgLyAzKTsKICAgIGcgPSBodWUycmdiKHAsIHEsIGgpOwogICAgYiA9IGh1ZTJyZ2IocCwgcSwgaCAtIDEgLyAzKTsKICB9CiAgcmV0dXJuIE1hdGgubWluKE1hdGguZmxvb3IoU1JnYkNvbG9yKHIpICogMjU2KSwgMjU1KSA8PCAxNiB8IE1hdGgubWluKE1hdGguZmxvb3IoU1JnYkNvbG9yKGcpICogMjU2KSwgMjU1KSA8PCA4IHwgTWF0aC5taW4oTWF0aC5mbG9vcihTUmdiQ29sb3IoYikgKiAyNTYpLCAyNTUpOwp9CmZ1bmN0aW9uIFJnYlRvSGxzKGNvbG9yKSB7CiAgY29uc3QgciA9IExpbmVhckNvbG9yKCgoY29sb3IgJiAweGZmMDAwMCkgPj4+IDE2KSAvIDI1NSk7CiAgY29uc3QgZyA9IExpbmVhckNvbG9yKCgoY29sb3IgJiAweGZmMDApID4+PiA4KSAvIDI1NSk7CiAgY29uc3QgYiA9IExpbmVhckNvbG9yKChjb2xvciAmIDB4ZmYpIC8gMjU1KTsKICBjb25zdCBtYXggPSBNYXRoLm1heChyLCBnLCBiKTsKICBjb25zdCBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTsKICBsZXQgaCwgczsKICBjb25zdCBsID0gKG1heCArIG1pbikgLyAyOwogIGlmIChtYXggPT09IG1pbikgewogICAgLyogQWNocm9tYXRpYyAqLwogICAgaCA9IHMgPSAwOwogIH0gZWxzZSB7CiAgICBjb25zdCBkID0gbWF4IC0gbWluOwogICAgcyA9IGwgPiAwLjUgPyBkIC8gKDIgLSBtYXggLSBtaW4pIDogZCAvIChtYXggKyBtaW4pOwogICAgc3dpdGNoIChtYXgpIHsKICAgICAgY2FzZSByOgogICAgICAgIGggPSAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBnOgogICAgICAgIGggPSAoYiAtIHIpIC8gZCArIDI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgYjoKICAgICAgICBoID0gKHIgLSBnKSAvIGQgKyA0OwogICAgICAgIGJyZWFrOwogICAgfQogICAgaCAvPSA2OwogIH0KICByZXR1cm4gewogICAgaCwKICAgIGwsCiAgICBzCiAgfTsKfQpmdW5jdGlvbiBMaWdodGVuKGNvbG9yLCBmYWN0b3IpIHsKICBjb25zdCBobHMgPSBSZ2JUb0hscyhjb2xvcik7CiAgaGxzLmwgKj0gZmFjdG9yOwogIGlmIChobHMubCA+IDEpIHsKICAgIGhscy5sID0gMTsKICB9CiAgcmV0dXJuIEhsc1RvUmdiKGhscyk7Cn0KZnVuY3Rpb24gRGFya2VuKGNvbG9yLCBmYWN0b3IpIHsKICBjb25zdCBobHMgPSBSZ2JUb0hscyhjb2xvcik7CiAgaGxzLmwgLz0gZmFjdG9yOwogIHJldHVybiBIbHNUb1JnYihobHMpOwp9"},{"version":3,"names":["three","BatchingKey","DxfWorker","MaterialKey","ColorCode","DxfScene","OrbitControls","RBTree","MessageLevel","Object","freeze","INFO","WARN","ERROR","DxfViewer","constructor","domContainer","options","create","DefaultOptions","assign","clearColor","getHex","scene","Scene","renderer","WebGLRenderer","alpha","canvasAlpha","premultipliedAlpha","canvasPremultipliedAlpha","antialias","depth","preserveDrawingBuffer","e","console","log","setPixelRatio","window","devicePixelRatio","camera","OrthographicCamera","position","z","x","y","simpleColorMaterial","simplePointMaterial","i","InstanceType","MAX","_CreateSimpleColorMaterial","_CreateSimplePointMaterial","setClearColor","clearAlpha","autoResize","canvasWidth","clientWidth","canvasHeight","clientHeight","style","resizeObserver","setSize","canvas","domElement","display","ResizeObserver","entries","_OnResize","observe","appendChild","addEventListener","_OnPointerEvent","bind","Render","materials","m1","m2","key","Compare","layers","Map","blocks","worker","HasRenderer","Boolean","GetRenderer","GetCanvas","GetDxf","parsedDxf","SetSize","width","height","_EnsureRenderer","hScale","vScale","cam","centerX","left","right","centerY","bottom","top","camWidth","camHeight","updateProjectionMatrix","controls","update","_Emit","Load","url","fonts","progressCbk","workerFactory","undefined","Error","Clear","dxf","Destroy","origin","bounds","hasMissingChars","layer","set","name","Layer","displayName","color","batch","batches","blockName","geometryType","GeometryType","BLOCK_INSTANCE","POINT_INSTANCE","block","get","Block","PushBatch","Batch","length","size","vertices","byteLength","indices","transforms","_LoadBatch","FitView","minX","maxX","minY","maxY","_Message","_CreateControls","render","GetLayers","result","lyr","values","push","_TransformColor","ShowLayer","show","obj","objects","visible","dispose","clear","Dispose","each","material","SetView","disconnect","m","center","aspect","zoom","rotation","updateMatrix","padding","Number","MIN_VALUE","GetScene","GetCamera","GetOrigin","GetBounds","Subscribe","eventName","eventHandler","EVENT_NAME_PREFIX","Unsubscribe","removeEventListener","enableRotate","mouseButtons","LEFT","MOUSE","PAN","MIDDLE","DOLLY","touches","ONE","TOUCH","TWO","DOLLY_PAN","zoomSpeed","mouseZoomSpeedFactor","target","Vector3","data","dispatchEvent","CustomEvent","detail","message","level","canvasRect","getBoundingClientRect","canvasCoord","clientX","clientY","type","domEvent","_CanvasToSceneCoord","v","unproject","entry","Math","floor","contentRect","CreateObjects","layerName","add","PushObject","_GetSimpleColorMaterial","instanceType","NONE","find","_CreateSimpleColorMaterialInstance","insert","shaders","_GenerateShaders","RawShaderMaterial","uniforms","value","Color","vertexShader","vertex","fragmentShader","fragment","depthTest","depthWrite","glslVersion","GLSL3","side","DoubleSide","src","clone","_GetSimplePointMaterial","POINTS","_CreateSimplePointMaterialInstance","pointSize","fullInstanceAttr","FULL","fullInstanceTransform","pointInstanceAttr","POINT","pointInstanceTransform","pointSizeUniform","pointSizeAssigment","colorCorrection","blackWhiteInversion","bkgLum","Luminance","fgLum","MIN_TARGET_RATIO","contrast","ContrastRatio","diff","targetLum","Lighten","Darken","sceneOptions","retainParsedDxf","fileEncoding","SetupWorker","self","viewer","hasOwnProperty","verticesArray","Float32Array","verticesOffset","BYTES_PER_ELEMENT","verticesSize","pointShapeHasDot","BufferAttribute","InstancedBufferAttribute","chunks","rawChunk","indicesArray","Uint16Array","indicesOffset","indicesSize","transformsArray","transformsOffset","transformsSize","buf","InstancedInterleavedBuffer","transforms0","InterleavedBufferAttribute","transforms1","layerColor","GetInstanceType","instanceBatch","_CreateBlockInstanceObjects","_CreateObjects","_instanceBatch$GetIns","_GetInstanceColor","materialFactory","call","objConstructor","Points","LINES","INDEXED_LINES","LineSegments","TRIANGLES","INDEXED_TRIANGLES","Mesh","CreateObject","geometry","InstancedBufferGeometry","BufferGeometry","setAttribute","_SetInstanceTransformAttribute","setIndex","frustumCulled","matrixAutoUpdate","chunk","isInstancedBufferGeometry","defColor","BY_BLOCK","BY_LAYER","LinearColor","c","pow","SRgbColor","r","g","b","c1","c2","HlsToRgb","h","l","s","hue2rgb","p","q","t","min","RgbToHls","max","d","factor","hls"],"sources":["C:/Users/SDC-8/Desktop/Sowndarya/CMTI ALL PROJECTS/GERB-INDIA(CLIENT)/GerbIndiaDashboard-CMTI-Full/SmartMetrology/smart-frontend/node_modules/dxf-viewer/src/DxfViewer.js"],"sourcesContent":["import * as three from \"three\"\nimport {BatchingKey} from \"./BatchingKey\"\nimport {DxfWorker} from \"./DxfWorker\"\nimport {MaterialKey} from \"./MaterialKey\"\nimport {ColorCode, DxfScene} from \"./DxfScene\"\nimport {OrbitControls} from \"./OrbitControls\"\nimport {RBTree} from \"./RBTree\"\n\n/** Level in \"message\" events. */\nconst MessageLevel = Object.freeze({\n    INFO: \"info\",\n    WARN: \"warn\",\n    ERROR: \"error\"\n})\n\n/** The representation class for the viewer, based on Three.js WebGL renderer. */\nexport class DxfViewer {\n\n    /** @param domContainer Container element to create the canvas in. Usually empty div. Should not\n     *  have padding if auto-resize feature is used.\n     * @param options Some options can be overridden if specified. See DxfViewer.DefaultOptions.\n     */\n    constructor(domContainer, options = null) {\n        this.domContainer = domContainer\n        this.options = Object.create(DxfViewer.DefaultOptions)\n        if (options) {\n            Object.assign(this.options, options)\n        }\n        options = this.options\n\n        this.clearColor = this.options.clearColor.getHex()\n\n        this.scene = new three.Scene()\n\n        try {\n            this.renderer = new three.WebGLRenderer({\n                alpha: options.canvasAlpha,\n                premultipliedAlpha: options.canvasPremultipliedAlpha,\n                antialias: options.antialias,\n                depth: false,\n                preserveDrawingBuffer: options.preserveDrawingBuffer\n            })\n        } catch (e) {\n            console.log(\"Failed to create renderer: \" + e)\n            this.renderer = null\n            return\n        }\n        const renderer = this.renderer\n        renderer.setPixelRatio(window.devicePixelRatio)\n\n        const camera = this.camera = new three.OrthographicCamera(-1, 1, 1, -1, 0.1, 2);\n        camera.position.z = 1\n        camera.position.x = 0\n        camera.position.y = 0\n\n        this.simpleColorMaterial = []\n        this.simplePointMaterial = []\n        for (let i = 0; i < InstanceType.MAX; i++) {\n            this.simpleColorMaterial[i] = this._CreateSimpleColorMaterial(i)\n            this.simplePointMaterial[i] = this._CreateSimplePointMaterial(i)\n        }\n\n        renderer.setClearColor(options.clearColor, options.clearAlpha)\n\n        if (options.autoResize) {\n            this.canvasWidth = domContainer.clientWidth\n            this.canvasHeight = domContainer.clientHeight\n            domContainer.style.position = \"relative\"\n        } else {\n            this.canvasWidth = options.canvasWidth\n            this.canvasHeight = options.canvasHeight\n            this.resizeObserver = null\n        }\n        renderer.setSize(this.canvasWidth, this.canvasHeight)\n\n        this.canvas = renderer.domElement\n        domContainer.style.display = \"block\"\n        if (options.autoResize) {\n            this.canvas.style.position = \"absolute\"\n            this.resizeObserver = new ResizeObserver(entries => this._OnResize(entries[0]))\n            this.resizeObserver.observe(domContainer)\n        }\n        domContainer.appendChild(this.canvas)\n\n        this.canvas.addEventListener(\"pointerdown\", this._OnPointerEvent.bind(this))\n        this.canvas.addEventListener(\"pointerup\", this._OnPointerEvent.bind(this))\n\n        this.Render()\n\n        /* Indexed by MaterialKey, value is {key, material}. */\n        this.materials = new RBTree((m1, m2) => m1.key.Compare(m2.key))\n        /* Indexed by layer name, value is Layer instance. */\n        this.layers = new Map()\n        /* Indexed by block name, value is Block instance. */\n        this.blocks = new Map()\n\n        /** Set during data loading. */\n        this.worker = null\n    }\n\n    /** @return {boolean} True if renderer exists. May be false in case when WebGL context is lost\n     * (e.g. after wake up from sleep). In such case page should be reloaded.\n     */\n    HasRenderer() {\n        return Boolean(this.renderer)\n    }\n\n    /**\n     * @returns {three.WebGLRenderer | null} Returns the created Three.js renderer.\n     */\n    GetRenderer(){\n        return this.renderer;\n    }\n\n    GetCanvas() {\n        return this.canvas\n    }\n\n    GetDxf() {\n        return this.parsedDxf\n    }\n\n    SetSize(width, height) {\n        this._EnsureRenderer()\n\n        const hScale = width / this.canvasWidth\n        const vScale = height / this.canvasHeight\n\n        const cam = this.camera\n        const centerX = (cam.left + cam.right) / 2\n        const centerY = (cam.bottom + cam.top) / 2\n        const camWidth = cam.right - cam.left\n        const camHeight = cam.top - cam.bottom\n        cam.left = centerX - hScale * camWidth / 2\n        cam.right = centerX + hScale * camWidth / 2\n        cam.bottom = centerY - vScale * camHeight / 2\n        cam.top = centerY + vScale * camHeight / 2\n        cam.updateProjectionMatrix()\n\n        this.canvasWidth = width\n        this.canvasHeight = height\n        this.renderer.setSize(width, height)\n        if (this.controls) {\n            this.controls.update()\n        }\n        this._Emit(\"resized\", {width, height})\n        this._Emit(\"viewChanged\")\n        this.Render()\n    }\n\n    /** Load DXF into the viewer. Old content is discarded, state is reset.\n     * @param url {string} DXF file URL.\n     * @param fonts {?string[]} List of font URLs. Files should have typeface.js format. Fonts are\n     *  used in the specified order, each one is checked until necessary glyph is found. Text is not\n     *  rendered if fonts are not specified.\n     * @param progressCbk {?Function} (phase, processedSize, totalSize)\n     *  Possible phase values:\n     *  * \"font\"\n     *  * \"fetch\"\n     *  * \"parse\"\n     *  * \"prepare\"\n     * @param workerFactory {?Function} Factory for worker creation. The worker script should\n     *  invoke DxfViewer.SetupWorker() function.\n     */\n    async Load({url, fonts = null, progressCbk = null, workerFactory = null}) {\n        if (url === null || url === undefined) {\n            throw new Error(\"`url` parameter is not specified\")\n        }\n\n        this._EnsureRenderer()\n\n        this.Clear()\n\n        this.worker = new DxfWorker(workerFactory ? workerFactory() : null)\n        const {scene, dxf} = await this.worker.Load(url, fonts, this.options, progressCbk)\n        await this.worker.Destroy()\n        this.worker = null\n        this.parsedDxf = dxf\n\n        this.origin = scene.origin\n        this.bounds = scene.bounds\n        this.hasMissingChars = scene.hasMissingChars\n\n        for (const layer of scene.layers) {\n            this.layers.set(layer.name, new Layer(layer.name, layer.displayName, layer.color))\n        }\n\n        /* Load all blocks on the first pass. */\n        for (const batch of scene.batches) {\n            if (batch.key.blockName !== null &&\n                batch.key.geometryType !== BatchingKey.GeometryType.BLOCK_INSTANCE &&\n                batch.key.geometryType !== BatchingKey.GeometryType.POINT_INSTANCE) {\n\n                let block = this.blocks.get(batch.key.blockName)\n                if (!block) {\n                    block = new Block()\n                    this.blocks.set(batch.key.blockName, block)\n                }\n                block.PushBatch(new Batch(this, scene, batch))\n            }\n        }\n\n        console.log(`DXF scene:\n                     ${scene.batches.length} batches,\n                     ${this.layers.size} layers,\n                     ${this.blocks.size} blocks,\n                     vertices ${scene.vertices.byteLength} B,\n                     indices ${scene.indices.byteLength} B\n                     transforms ${scene.transforms.byteLength} B`)\n\n        /* Instantiate all entities. */\n        for (const batch of scene.batches) {\n            this._LoadBatch(scene, batch)\n        }\n\n        this._Emit(\"loaded\")\n\n        if (scene.bounds) {\n            this.FitView(scene.bounds.minX - scene.origin.x, scene.bounds.maxX - scene.origin.x,\n                         scene.bounds.minY - scene.origin.y, scene.bounds.maxY - scene.origin.y)\n        } else {\n            this._Message(\"Empty document\", MessageLevel.WARN)\n        }\n\n        if (this.hasMissingChars) {\n            this._Message(\"Some characters cannot be properly displayed due to missing fonts\",\n                          MessageLevel.WARN)\n        }\n\n        this._CreateControls()\n        this.Render()\n    }\n\n    Render() {\n        this._EnsureRenderer()\n        this.renderer.render(this.scene, this.camera)\n    }\n\n    /** @return {Iterable<{name:String, color:number}>} List of layer names. */\n    GetLayers() {\n        const result = []\n        for (const lyr of this.layers.values()) {\n            result.push({\n                name: lyr.name,\n                displayName: lyr.displayName,\n                color: this._TransformColor(lyr.color)\n            })\n        }\n        return result\n    }\n\n    ShowLayer(name, show) {\n        this._EnsureRenderer()\n        const layer = this.layers.get(name)\n        if (!layer) {\n            return\n        }\n        for (const obj of layer.objects) {\n            obj.visible = show\n        }\n        this.Render()\n    }\n\n    /** Reset the viewer state. */\n    Clear() {\n        this._EnsureRenderer()\n        if (this.worker) {\n            this.worker.Destroy(true)\n            this.worker = null\n        }\n        if (this.controls) {\n            this.controls.dispose()\n            this.controls = null\n        }\n        this.scene.clear()\n        for (const layer of this.layers.values()) {\n            layer.Dispose()\n        }\n        this.layers.clear()\n        this.blocks.clear()\n        this.materials.each(e => e.material.dispose())\n        this.materials.clear()\n        this.SetView({x: 0, y: 0}, 2)\n        this._Emit(\"cleared\")\n        this.Render()\n    }\n\n    /** Free all resources. The viewer object should not be used after this method was called. */\n    Destroy() {\n        if (!this.HasRenderer()) {\n            return\n        }\n        if (this.resizeObserver) {\n            this.resizeObserver.disconnect()\n        }\n        this.Clear()\n        this._Emit(\"destroyed\")\n        for (const m of this.simplePointMaterial) {\n            m.dispose()\n        }\n        for (const m of this.simpleColorMaterial) {\n            m.dispose()\n        }\n        this.simplePointMaterial = null\n        this.simpleColorMaterial = null\n        this.renderer.dispose()\n        this.renderer = null\n    }\n\n    SetView(center, width) {\n        const aspect = this.canvasWidth / this.canvasHeight\n        const height = width / aspect\n        const cam = this.camera\n        cam.left = -width / 2\n        cam.right = width / 2\n        cam.top = height / 2\n        cam.bottom = -height / 2\n        cam.zoom = 1\n        cam.position.set(center.x, center.y, 1)\n        cam.rotation.set(0, 0, 0)\n        cam.updateMatrix()\n        cam.updateProjectionMatrix()\n        this._Emit(\"viewChanged\")\n    }\n\n    /** Set view to fit the specified bounds. */\n    FitView(minX, maxX, minY, maxY, padding = 0.1) {\n        const aspect = this.canvasWidth / this.canvasHeight\n        let width = maxX - minX\n        const height = maxY - minY\n        const center = {x: minX + width / 2, y: minY + height / 2}\n        if (height * aspect > width) {\n            width = height * aspect\n        }\n        if (width <= Number.MIN_VALUE * 2) {\n            width = 1\n        }\n        this.SetView(center, width * (1 + padding))\n    }\n\n    /** @return {Scene} three.js scene for the viewer. Can be used to add custom entities on the\n     *      scene. Remember to apply scene origin available via GetOrigin() method.\n     */\n    GetScene() {\n        return this.scene\n    }\n\n    /** @return {OrthographicCamera} three.js camera for the viewer. */\n    GetCamera() {\n        return this.camera\n    }\n\n    /** @return {Vector2} Scene origin in global drawing coordinates. */\n    GetOrigin() {\n        return this.origin\n    }\n\n    /**\n     * @return {?{maxX: number, maxY: number, minX: number, minY: number}} Scene bounds in model\n     *      space coordinates. Null if empty scene.\n     */\n    GetBounds() {\n        return this.bounds\n    }\n\n    /** Subscribe to the specified event. The following events are defined:\n     *  * \"loaded\" - new scene loaded.\n     *  * \"cleared\" - current scene cleared.\n     *  * \"destroyed\" - viewer instance destroyed.\n     *  * \"resized\" - viewport size changed. Details: {width, height}\n     *  * \"pointerdown\" - Details: {domEvent, position:{x,y}}, position is in scene coordinates.\n     *  * \"pointerup\"\n     *  * \"viewChanged\"\n     *  * \"message\" - Some message from the viewer. {message: string, level: string}.\n     *\n     * @param eventName {string}\n     * @param eventHandler {function} Accepts event object.\n     */\n    Subscribe(eventName, eventHandler) {\n        this._EnsureRenderer()\n        this.canvas.addEventListener(EVENT_NAME_PREFIX + eventName, eventHandler)\n    }\n\n    /** Unsubscribe from previously subscribed event. The arguments should match previous\n     * Subscribe() call.\n     *\n     * @param eventName {string}\n     * @param eventHandler {function}\n     */\n    Unsubscribe(eventName, eventHandler) {\n        this._EnsureRenderer()\n        this.canvas.removeEventListener(EVENT_NAME_PREFIX + eventName, eventHandler)\n    }\n\n    // /////////////////////////////////////////////////////////////////////////////////////////////\n\n    _EnsureRenderer() {\n        if (!this.HasRenderer()) {\n            throw new Error(\"WebGL renderer not available. \" +\n                            \"Probable WebGL context loss, try refreshing the page.\")\n        }\n    }\n\n    _CreateControls() {\n        const controls = this.controls = new OrbitControls(this.camera, this.canvas)\n        controls.enableRotate = false\n        controls.mouseButtons = {\n            LEFT: three.MOUSE.PAN,\n            MIDDLE: three.MOUSE.DOLLY\n        }\n        controls.touches = {\n            ONE: three.TOUCH.PAN,\n            TWO: three.TOUCH.DOLLY_PAN\n        }\n        controls.zoomSpeed = 3\n        controls.mouseZoomSpeedFactor = 0.05\n        controls.target = new three.Vector3(this.camera.position.x, this.camera.position.y, 0)\n        controls.addEventListener(\"change\", () => {\n            this._Emit(\"viewChanged\")\n            this.Render()\n        })\n        controls.update()\n    }\n\n    _Emit(eventName, data = null) {\n        this.canvas.dispatchEvent(new CustomEvent(EVENT_NAME_PREFIX + eventName, { detail: data }))\n    }\n\n    _Message(message, level = MessageLevel.INFO) {\n        this._Emit(\"message\", {message, level})\n    }\n\n    _OnPointerEvent(e) {\n        const canvasRect = e.target.getBoundingClientRect()\n        const canvasCoord = {x: e.clientX - canvasRect.left, y: e.clientY - canvasRect.top}\n        this._Emit(e.type, {\n            domEvent: e,\n            canvasCoord,\n            position: this._CanvasToSceneCoord(canvasCoord.x, canvasCoord.y)\n        })\n    }\n\n    /** @return {{x,y}} Scene coordinate corresponding to the specified canvas pixel coordinates. */\n    _CanvasToSceneCoord(x, y) {\n        const v = new three.Vector3(x * 2 / this.canvasWidth - 1,\n                                    -y * 2 / this.canvasHeight + 1,\n                                    1).unproject(this.camera)\n        return {x: v.x, y: v.y}\n    }\n\n    _OnResize(entry) {\n        this.SetSize(Math.floor(entry.contentRect.width), Math.floor(entry.contentRect.height))\n    }\n\n    _LoadBatch(scene, batch) {\n        if (batch.key.blockName !== null &&\n            batch.key.geometryType !== BatchingKey.GeometryType.BLOCK_INSTANCE &&\n            batch.key.geometryType !== BatchingKey.GeometryType.POINT_INSTANCE) {\n            /* Block definition. */\n            return\n        }\n        const objects = new Batch(this, scene, batch).CreateObjects()\n\n        const layer = this.layers.get(batch.key.layerName)\n\n        for (const obj of objects) {\n            this.scene.add(obj)\n            if (layer) {\n                layer.PushObject(obj)\n            }\n        }\n    }\n\n    _GetSimpleColorMaterial(color, instanceType = InstanceType.NONE) {\n        const key = new MaterialKey(instanceType, null, color, 0)\n        let entry = this.materials.find({key})\n        if (entry !== null) {\n            return entry.material\n        }\n        entry = {\n            key,\n            material: this._CreateSimpleColorMaterialInstance(color, instanceType)\n        }\n        this.materials.insert(entry)\n        return entry.material\n    }\n\n    _CreateSimpleColorMaterial(instanceType = InstanceType.NONE) {\n        const shaders = this._GenerateShaders(instanceType, false)\n        return new three.RawShaderMaterial({\n            uniforms: {\n                color: {\n                    value: new three.Color(0xff00ff)\n                }\n            },\n            vertexShader: shaders.vertex,\n            fragmentShader: shaders.fragment,\n            depthTest: false,\n            depthWrite: false,\n            glslVersion: three.GLSL3,\n            side: three.DoubleSide\n        })\n    }\n\n    /** @param color {number} Color RGB numeric value.\n     * @param instanceType {number}\n     */\n    _CreateSimpleColorMaterialInstance(color, instanceType = InstanceType.NONE) {\n        const src = this.simpleColorMaterial[instanceType]\n        /* Should reuse compiled shaders. */\n        const m = src.clone()\n        m.uniforms.color = { value: new three.Color(color) }\n        return m\n    }\n\n    _GetSimplePointMaterial(color, instanceType = InstanceType.NONE) {\n        const key = new MaterialKey(instanceType, BatchingKey.GeometryType.POINTS, color, 0)\n        let entry = this.materials.find({key})\n        if (entry !== null) {\n            return entry.material\n        }\n        entry = {\n            key,\n            material: this._CreateSimplePointMaterialInstance(color, this.options.pointSize,\n                                                              instanceType)\n        }\n        this.materials.insert(entry)\n        return entry.material\n    }\n\n    _CreateSimplePointMaterial(instanceType = InstanceType.NONE) {\n        const shaders = this._GenerateShaders(instanceType, true)\n        return new three.RawShaderMaterial({\n            uniforms: {\n                color: {\n                    value: new three.Color(0xff00ff)\n                },\n                pointSize: {\n                    value: 2\n                }\n            },\n            vertexShader: shaders.vertex,\n            fragmentShader: shaders.fragment,\n            depthTest: false,\n            depthWrite: false,\n            glslVersion: three.GLSL3\n        })\n    }\n\n    /** @param color {number} Color RGB numeric value.\n     * @param size {number} Rasterized point size in pixels.\n     * @param instanceType {number}\n     */\n    _CreateSimplePointMaterialInstance(color, size = 2, instanceType = InstanceType.NONE) {\n        const src = this.simplePointMaterial[instanceType]\n        /* Should reuse compiled shaders. */\n        const m = src.clone()\n        m.uniforms.color = { value: new three.Color(color) }\n        m.uniforms.size = { value: size }\n        return m\n    }\n\n    _GenerateShaders(instanceType, pointSize) {\n        const fullInstanceAttr = instanceType === InstanceType.FULL ?\n            `\n            /* First row. */\n            in vec3 instanceTransform0;\n            /* Second row. */\n            in vec3 instanceTransform1;\n            ` : \"\"\n        const fullInstanceTransform = instanceType === InstanceType.FULL ?\n            `\n            pos.xy = mat2(instanceTransform0[0], instanceTransform1[0],\n                          instanceTransform0[1], instanceTransform1[1]) * pos.xy +\n                     vec2(instanceTransform0[2], instanceTransform1[2]);\n            ` : \"\"\n\n        const pointInstanceAttr = instanceType === InstanceType.POINT ?\n            `\n            in vec2 instanceTransform;\n            ` : \"\"\n        const pointInstanceTransform = instanceType === InstanceType.POINT ?\n            `\n            pos.xy += instanceTransform;\n            ` : \"\"\n\n        const pointSizeUniform = pointSize ? \"uniform float pointSize;\" : \"\"\n        const pointSizeAssigment = pointSize ? \"gl_PointSize = pointSize;\" : \"\"\n\n        return {\n            vertex: `\n\n            precision highp float;\n            precision highp int;\n            in vec2 position;\n            ${fullInstanceAttr}\n            ${pointInstanceAttr}\n            uniform mat4 modelViewMatrix;\n            uniform mat4 projectionMatrix;\n            ${pointSizeUniform}\n\n            void main() {\n                vec4 pos = vec4(position, 0.0, 1.0);\n                ${fullInstanceTransform}\n                ${pointInstanceTransform}\n                gl_Position = projectionMatrix * modelViewMatrix * pos;\n                ${pointSizeAssigment}\n            }\n            `,\n            fragment: `\n\n            precision highp float;\n            precision highp int;\n            uniform vec3 color;\n            out vec4 fragColor;\n\n            void main() {\n                fragColor = vec4(color, 1.0);\n            }\n            `\n        }\n    }\n\n    /** Ensure the color is contrast enough with current background color.\n     * @param color {number} RGB value.\n     * @return {number} RGB value to use for rendering.\n     */\n    _TransformColor(color) {\n        if (!this.options.colorCorrection && !this.options.blackWhiteInversion) {\n            return color\n        }\n        /* Just black and white inversion. */\n        const bkgLum = Luminance(this.clearColor)\n        if (color === 0xffffff && bkgLum >= 0.8) {\n            return 0\n        }\n        if (color === 0 && bkgLum <= 0.2) {\n            return 0xffffff\n        }\n        if (!this.options.colorCorrection) {\n            return color\n        }\n        const fgLum = Luminance(color)\n        const MIN_TARGET_RATIO = 1.5\n        const contrast = ContrastRatio(color, this.clearColor)\n        const diff = contrast >= 1 ? contrast : 1 / contrast\n        if (diff < MIN_TARGET_RATIO) {\n            let targetLum\n            if (bkgLum > 0.5) {\n                targetLum = bkgLum / 2\n            } else {\n                targetLum = bkgLum * 2\n            }\n            if (targetLum > fgLum) {\n                color = Lighten(color, targetLum / fgLum)\n            } else {\n                color = Darken(color, fgLum / targetLum)\n            }\n        }\n        return color\n    }\n}\n\nDxfViewer.MessageLevel = MessageLevel\n\nDxfViewer.DefaultOptions = {\n    canvasWidth: 400,\n    canvasHeight: 300,\n    /** Automatically resize canvas when the container is resized. This options utilizes\n     *  ResizeObserver API which is still not fully standardized. The specified canvas size is\n     *  ignored if the option is enabled.\n     */\n    autoResize: false,\n    /** Frame buffer clear color. */\n    clearColor: new three.Color(\"#000\"),\n    /** Frame buffer clear color alpha value. */\n    clearAlpha: 1.0,\n    /** Use alpha channel in a framebuffer. */\n    canvasAlpha: false,\n    /** Assume premultiplied alpha in a framebuffer. */\n    canvasPremultipliedAlpha: true,\n    /** Use antialiasing. May degrade performance on poor hardware. */\n    antialias: true,\n    /** Correct entities colors to ensure that they are always visible with the current background\n     * color.\n     */\n    colorCorrection: false,\n    /** Simpler version of colorCorrection - just invert pure white or black entities if they are\n     * invisible on current background color.\n     */\n    blackWhiteInversion: true,\n    /** Size in pixels for rasterized points (dot mark). */\n    pointSize: 2,\n    /** Scene generation options. */\n    sceneOptions: DxfScene.DefaultOptions,\n    /** Retain the simple object representing the parsed DXF - will consume a lot of additional\n     * memory.\n     */\n    retainParsedDxf: false,\n    /** Whether to preserve the buffers until manually cleared or overwritten. */\n    preserveDrawingBuffer: false,\n    /** Encoding to use for decoding DXF file text content. DXF files newer than DXF R2004 (AC1018)\n     * use UTF-8 encoding. Older files use some code page which is specified in $DWGCODEPAGE header\n     * variable. Currently parser is implemented in such a way that encoding must be specified\n     * before the content is parsed so there is no chance to use this variable dynamically. This may\n     * be a subject for future changes. The specified value should be suitable for passing as\n     * `TextDecoder` constructor `label` parameter.\n     */\n    fileEncoding: \"utf-8\"\n}\n\nDxfViewer.SetupWorker = function () {\n    new DxfWorker(self, true)\n}\n\nconst InstanceType = Object.freeze({\n    /** Not instanced. */\n    NONE: 0,\n    /** Full affine transform per instance. */\n    FULL: 1,\n    /** Point instances, 2D-translation vector per instance. */\n    POINT: 2,\n\n    /** Number of types. */\n    MAX: 3\n})\n\nclass Batch {\n    /**\n     * @param viewer {DxfViewer}\n     * @param scene Serialized scene.\n     * @param batch Serialized scene batch.\n     */\n    constructor(viewer, scene, batch) {\n        this.viewer = viewer\n        this.key = batch.key\n\n        if (batch.hasOwnProperty(\"verticesOffset\")) {\n            const verticesArray =\n                new Float32Array(scene.vertices,\n                                 batch.verticesOffset * Float32Array.BYTES_PER_ELEMENT,\n                                 batch.verticesSize)\n            if (this.key.geometryType !== BatchingKey.GeometryType.POINT_INSTANCE ||\n                scene.pointShapeHasDot) {\n                this.vertices = new three.BufferAttribute(verticesArray, 2)\n            }\n            if (this.key.geometryType === BatchingKey.GeometryType.POINT_INSTANCE) {\n                this.transforms = new three.InstancedBufferAttribute(verticesArray, 2)\n            }\n        }\n\n        if (batch.hasOwnProperty(\"chunks\")) {\n            this.chunks = []\n            for (const rawChunk of batch.chunks) {\n\n                const verticesArray =\n                    new Float32Array(scene.vertices,\n                                     rawChunk.verticesOffset * Float32Array.BYTES_PER_ELEMENT,\n                                     rawChunk.verticesSize)\n                const indicesArray =\n                    new Uint16Array(scene.indices,\n                                    rawChunk.indicesOffset * Uint16Array.BYTES_PER_ELEMENT,\n                                    rawChunk.indicesSize)\n                this.chunks.push({\n                    vertices: new three.BufferAttribute(verticesArray, 2),\n                    indices: new three.BufferAttribute(indicesArray, 1)\n                })\n            }\n        }\n\n        if (batch.hasOwnProperty(\"transformsOffset\")) {\n            const transformsArray =\n                new Float32Array(scene.transforms,\n                                 batch.transformsOffset * Float32Array.BYTES_PER_ELEMENT,\n                                 batch.transformsSize)\n            /* Each transform is 3x2 matrix which is split into two 3D vectors which will occupy two\n             * attribute slots.\n             */\n            const buf = new three.InstancedInterleavedBuffer(transformsArray, 6)\n            this.transforms0 = new three.InterleavedBufferAttribute(buf, 3, 0)\n            this.transforms1 = new three.InterleavedBufferAttribute(buf, 3, 3)\n        }\n\n        if (this.key.geometryType === BatchingKey.GeometryType.BLOCK_INSTANCE ||\n            this.key.geometryType === BatchingKey.GeometryType.POINT_INSTANCE) {\n\n            const layer = this.viewer.layers.get(this.key.layerName)\n            if (layer) {\n                this.layerColor = layer.color\n            } else {\n                this.layerColor = 0\n            }\n        }\n    }\n\n    GetInstanceType() {\n        switch (this.key.geometryType) {\n        case BatchingKey.GeometryType.BLOCK_INSTANCE:\n            return InstanceType.FULL\n        case BatchingKey.GeometryType.POINT_INSTANCE:\n            return InstanceType.POINT\n        default:\n            return InstanceType.NONE\n        }\n    }\n\n    /** Create scene objects corresponding to batch data.\n     * @param instanceBatch {?Batch} Batch with instance transform. Null for non-instanced object.\n     */\n    *CreateObjects(instanceBatch = null) {\n        if (this.key.geometryType === BatchingKey.GeometryType.BLOCK_INSTANCE ||\n            this.key.geometryType === BatchingKey.GeometryType.POINT_INSTANCE) {\n\n            if (instanceBatch !== null) {\n                throw new Error(\"Unexpected instance batch specified for instance batch\")\n            }\n            yield* this._CreateBlockInstanceObjects()\n            return\n        }\n        yield* this._CreateObjects(instanceBatch)\n    }\n\n    *_CreateObjects(instanceBatch) {\n        const color = instanceBatch ?\n            instanceBatch._GetInstanceColor(this.key.color) : this.key.color\n\n        //XXX line type\n        const materialFactory =\n            this.key.geometryType === BatchingKey.GeometryType.POINTS ||\n            this.key.geometryType === BatchingKey.GeometryType.POINT_INSTANCE ?\n                this.viewer._GetSimplePointMaterial : this.viewer._GetSimpleColorMaterial\n\n        const material = materialFactory.call(this.viewer, this.viewer._TransformColor(color),\n                                              instanceBatch?.GetInstanceType() ?? InstanceType.NONE)\n\n        let objConstructor\n        switch (this.key.geometryType) {\n        case BatchingKey.GeometryType.POINTS:\n        /* This method also called for creating dots for shaped point instances. */\n        case BatchingKey.GeometryType.POINT_INSTANCE:\n            objConstructor = three.Points\n            break\n        case BatchingKey.GeometryType.LINES:\n        case BatchingKey.GeometryType.INDEXED_LINES:\n            objConstructor = three.LineSegments\n            break\n        case BatchingKey.GeometryType.TRIANGLES:\n        case BatchingKey.GeometryType.INDEXED_TRIANGLES:\n            objConstructor = three.Mesh\n            break\n        default:\n            throw new Error(\"Unexpected geometry type:\" + this.key.geometryType)\n        }\n\n        function CreateObject(vertices, indices) {\n            const geometry = instanceBatch ?\n                new three.InstancedBufferGeometry() : new three.BufferGeometry()\n            geometry.setAttribute(\"position\", vertices)\n            instanceBatch?._SetInstanceTransformAttribute(geometry)\n            if (indices) {\n                geometry.setIndex(indices)\n            }\n            const obj = new objConstructor(geometry, material)\n            obj.frustumCulled = false\n            obj.matrixAutoUpdate = false\n            return obj\n        }\n\n        if (this.chunks) {\n            for (const chunk of this.chunks) {\n                yield CreateObject(chunk.vertices, chunk.indices)\n            }\n        } else {\n            yield CreateObject(this.vertices)\n        }\n    }\n\n    /**\n     * @param geometry {InstancedBufferGeometry}\n     */\n    _SetInstanceTransformAttribute(geometry) {\n        if (!geometry.isInstancedBufferGeometry) {\n            throw new Error(\"InstancedBufferGeometry expected\")\n        }\n        if (this.key.geometryType === BatchingKey.GeometryType.POINT_INSTANCE) {\n            geometry.setAttribute(\"instanceTransform\", this.transforms)\n        } else {\n            geometry.setAttribute(\"instanceTransform0\", this.transforms0)\n            geometry.setAttribute(\"instanceTransform1\", this.transforms1)\n        }\n    }\n\n    *_CreateBlockInstanceObjects() {\n        const block = this.viewer.blocks.get(this.key.blockName)\n        if (!block) {\n            return\n        }\n        for (const batch of block.batches) {\n            yield* batch.CreateObjects(this)\n        }\n        if (this.hasOwnProperty(\"vertices\")) {\n            /* Dots for point shapes. */\n            yield* this._CreateObjects()\n        }\n    }\n\n    /**\n     * @param defColor {number} Color value for block definition batch.\n     * @return {number} RGB color value for a block instance.\n     */\n    _GetInstanceColor(defColor) {\n        if (defColor === ColorCode.BY_BLOCK) {\n            return this.key.color\n        } else if (defColor === ColorCode.BY_LAYER) {\n            return this.layerColor\n        } else {\n            return defColor\n        }\n    }\n}\n\nclass Layer {\n    constructor(name, displayName, color) {\n        this.name = name\n        this.displayName = displayName\n        this.color = color\n        this.objects = []\n    }\n\n    PushObject(obj) {\n        this.objects.push(obj)\n    }\n\n    Dispose() {\n        for (const obj of this.objects) {\n            obj.geometry.dispose()\n        }\n        this.objects = null\n    }\n}\n\nclass Block {\n    constructor() {\n        this.batches = []\n    }\n\n    /** @param batch {Batch} */\n    PushBatch(batch) {\n        this.batches.push(batch)\n    }\n}\n\n/** Custom viewer event names are prefixed with this string. */\nconst EVENT_NAME_PREFIX = \"__dxf_\"\n\n/** Transform sRGB color component to linear color space. */\nfunction LinearColor(c) {\n    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4)\n}\n\n/** Transform linear color component to sRGB color space. */\nfunction SRgbColor(c) {\n    return c < 0.003 ? c * 12.92 : Math.pow(c, 1 / 2.4) * 1.055 - 0.055\n}\n\n/** Get relative luminance value for a color.\n * https://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n * @param color {number} RGB color value.\n * @return {number} Luminance value in range [0; 1].\n */\nfunction Luminance(color) {\n    const r = LinearColor(((color & 0xff0000) >>> 16) / 255)\n    const g = LinearColor(((color & 0xff00) >>> 8) / 255)\n    const b = LinearColor((color & 0xff) / 255)\n\n    return r * 0.2126 + g * 0.7152 + b * 0.0722\n}\n\n/**\n * Get contrast ratio for a color pair.\n * https://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef\n * @param c1\n * @param c2\n * @return {number} Contrast ratio between the colors. Greater than one if the first color color is\n *  brighter than the second one.\n */\nfunction ContrastRatio(c1, c2) {\n    return (Luminance(c1) + 0.05) / (Luminance(c2) + 0.05)\n}\n\nfunction HlsToRgb({h, l, s}) {\n    let r, g, b\n    if (s === 0) {\n        /* Achromatic */\n        r = g = b = l\n    } else {\n        function hue2rgb(p, q, t) {\n            if (t < 0) {\n                t += 1\n            }\n            if (t > 1) {\n                t -= 1\n            }\n            if (t < 1/6) {\n                return p + (q - p) * 6 * t\n            }\n            if (t < 1/2) {\n                return q\n            }\n            if (t < 2/3) {\n                return p + (q - p) * (2/3 - t) * 6\n            }\n            return p\n        }\n\n        const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n        const p = 2 * l - q\n        r = hue2rgb(p, q, h + 1/3)\n        g = hue2rgb(p, q, h)\n        b = hue2rgb(p, q, h - 1/3)\n    }\n\n    return (Math.min(Math.floor(SRgbColor(r) * 256), 255) << 16) |\n           (Math.min(Math.floor(SRgbColor(g) * 256), 255) << 8) |\n            Math.min(Math.floor(SRgbColor(b) * 256), 255)\n}\n\nfunction RgbToHls(color) {\n    const r = LinearColor(((color & 0xff0000) >>> 16) / 255)\n    const g = LinearColor(((color & 0xff00) >>> 8) / 255)\n    const b = LinearColor((color & 0xff) / 255)\n\n    const max = Math.max(r, g, b)\n    const min = Math.min(r, g, b)\n    let h, s\n    const l = (max + min) / 2\n\n    if (max === min) {\n        /* Achromatic */\n        h = s = 0\n    } else {\n        const d = max - min\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min)\n        switch (max) {\n        case r:\n            h = (g - b) / d + (g < b ? 6 : 0)\n            break;\n        case g:\n            h = (b - r) / d + 2\n            break\n        case b:\n            h = (r - g) / d + 4\n            break\n        }\n        h /= 6\n    }\n\n    return {h, l, s}\n}\n\nfunction Lighten(color, factor) {\n    const hls = RgbToHls(color)\n    hls.l *= factor\n    if (hls.l > 1) {\n        hls.l = 1\n    }\n    return HlsToRgb(hls)\n}\n\nfunction Darken(color, factor) {\n    const hls = RgbToHls(color)\n    hls.l /= factor\n    return HlsToRgb(hls)\n}\n"],"mappings":"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"}]}